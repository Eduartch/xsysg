*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ka_sfcaja.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS fmr1 AS fmr OF "..\libs\sisven.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="optdetalles" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtimporte" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdaceptar1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcerraro1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="statusbar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdetalle" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: fecha
		*p: usuario
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 1
	Caption = "[Sobrantes Y Faltantes de Caja]"
	DoCreate = .T.
	fecha = 
	FontSize = 8
	Height = 172
	Name = "Fmr1"
	usuario = 
	Width = 416
	WindowType = 1

	ADD OBJECT 'Cmdaceptar1' AS cmdaceptar WITH ;
		Left = 321, ;
		Name = "Cmdaceptar1", ;
		TabIndex = 5, ;
		Top = 21
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcerraro1' AS cmdcerraro WITH ;
		Height = 42, ;
		Left = 322, ;
		Name = "Cmdcerraro1", ;
		TabIndex = 6, ;
		Top = 92, ;
		Width = 90
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		Caption = "Importe", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontOutline = .F., ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 24, ;
		Name = "Label1", ;
		TabIndex = 4, ;
		Top = 54, ;
		Width = 60
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		Caption = "Detalle:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontOutline = .F., ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 24, ;
		Name = "Label2", ;
		TabIndex = 8, ;
		Top = 96, ;
		Width = 60
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'optdetalles' AS optiongroup WITH ;
		ButtonCount = 2, ;
		Height = 46, ;
		Left = 24, ;
		Name = "optdetalles", ;
		TabIndex = 1, ;
		Top = 0, ;
		Value = 1, ;
		Width = 156, ;
		Option1.Caption = "Faltante", ;
		Option1.FontBold = .T., ;
		Option1.FontName = "Tahoma", ;
		Option1.FontSize = 8, ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "optfaltante", ;
		Option1.Top = 5, ;
		Option1.Value = 1, ;
		Option1.Width = 79, ;
		Option2.Caption = "Sobrante", ;
		Option2.FontBold = .T., ;
		Option2.FontName = "Tahoma", ;
		Option2.FontSize = 8, ;
		Option2.Height = 17, ;
		Option2.Left = 5, ;
		Option2.Name = "optsobarnte", ;
		Option2.Top = 24, ;
		Option2.Width = 91
		*< END OBJECT: BaseClass="optiongroup" />

	ADD OBJECT 'statusbar' AS olecontrol WITH ;
		Align = 2, ;
		Height = 28, ;
		Left = 0, ;
		Name = "statusbar", ;
		TabIndex = 7, ;
		Top = 144, ;
		Width = 416
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\comctl32.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCSnTK/EtcBAwAAAMABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAzAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v///wUAAAAGAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+PY35rCoUbEK/AQhAQKo2nIUM0EggAAAD/KgAA5QIAAIh+4eYCAAUAiAAAAAAAAAD//xkAAe/NqwAABQDw6RkATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIC0wMDAwRjg3NTREQTFjAHgAAAAcAAAAAAAoIyTqAAAM/yABAAD///9/////fw0AXgABAACAHAAAAAAAAAAYEDoEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////AAAAAKsAAAAAAAAABgAAAP//////////GMasAAAAAAACAAAAoARcAOwJAADsCQAAAwAAAAcAAABDAGEAagBlAHIAbwA6AAcAAABDAGEAagBlAHIAbwA6AKDkWCfsCQAA7AkAAAMAAAAGAAAARgBlAGMAaABhADoABgAAAEYAZQBjAGgAYQA6AAAAAAAf3uy9AQAFAMAAAAAAAAAAAAAAAAAAAAAAAAAA//////////8AAAAAqQAAAAAAAAAJIyTqAAAM/0EBAAD///9/////f///TwBJAA8AHAAAAAAAAABQDjoEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////AAAAAA==" />

	ADD OBJECT 'txtdetalle' AS textbox WITH ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 24, ;
		Name = "txtdetalle", ;
		SpecialEffect = 1, ;
		TabIndex = 3, ;
		Top = 113, ;
		Width = 252
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtimporte' AS textbox WITH ;
		Alignment = 3, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "999,999.99", ;
		Height = 23, ;
		InputMask = "999,999.99", ;
		Left = 24, ;
		MaxLength = 0, ;
		Name = "txtimporte", ;
		SpecialEffect = 1, ;
		TabIndex = 2, ;
		Top = 71, ;
		Value = 0, ;
		Width = 100
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Init
		LPARAMETERS cusuario,dfecha
		thisform.statusBar.Panels.Item(1).Text ="Cajero:"+ALLTRIM(cusuario)
		thisform.statusBar.Panels.Item(2).Text ="Fecha:"+DTOC(dfecha)
		thisform.usuario=cusuario
		thisform.fecha=dfecha
	ENDPROC

	PROCEDURE Cmdaceptar1.Click
		LOCAL rpta as Integer 
		IF thisform.txtimporte.Value<=0 AND EMPTY(thisform.txtdetalle.Value)
		   thisform.txtimporte.SetFocus 
		   RETURN 
		ENDIF 
		rpta=MESSAGEBOX("¿Datos Ok[S/N]?",32+3+0,MSGTITULO)
		nic=1
		cidpc=ID()
		cusuario=thisform.usuario 
		corigen="CC"
		dfechao=DATETIME()
		cndoc=IIF(thisform.optdetalles.optfaltante.Value=1,"Sobrantes","Faltantes")
		dfecha=thisform.fecha 
		ctipo=IIF(thisform.optdetalles.optfaltante.Value=1,"I","S")
		nimporte=thisform.txtimporte.Value 
		cdetalle=thisform.txtdetalle.Value 
		ccajero=thisform.usuario 
		DO CASE 
		   CASE rpta=2
		        thisform.txtimporte.SetFocus
		        RETURN  
		   CASE rpta=6
		        IF thisform.optdetalles.optfaltante.Value=1
		           TEXT TO lc NOSHOW 
		             INSERT INTO fe_sfcaja(fech,faltan,fechsfcaja,idpcsfcaja,usuasfcaja,cajero)
		             values(?dfecha,?nimporte,?dfechao,?cidpc,?cusuario,?ccajero)
		           ENDTEXT   
		          ELSE
		           TEXT TO lc NOSHOW 
		             INSERT INTO fe_sfcaja(fech,sobran,fechsfcaja,idpcsfcaja,usuasfcaja,cajero)
		             values(?dfecha,?nimporte,?dfechao,?cidpc,?cusuario,?ccajero)
		           ENDTEXT 
		         ENDIF   
		         	IF verificaconexion()=0 then
		RETURN 0
		endif 
		        IF SQLEXEC(goapp.bdconn,lc)<1
		           errorbd(lc)
		        ENDIF 
		        thisform.cmdcerraro1.Click()
		   CASE rpta=7
		        thisform.cmdcerraro1.Click()
		ENDCASE 
	ENDPROC

	PROCEDURE txtdetalle.GotFocus
		this.BackColor=RGB(247,252,186)
	ENDPROC

	PROCEDURE txtdetalle.LostFocus
		this.BackColor=RGB(255,255,255)
	ENDPROC

	PROCEDURE txtimporte.GotFocus
		this.BackColor=RGB(247,252,186)
	ENDPROC

	PROCEDURE txtimporte.LostFocus
		this.BackColor=RGB(255,255,255)
	ENDPROC

ENDDEFINE
