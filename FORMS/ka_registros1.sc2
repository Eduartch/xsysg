*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ka_registros1.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 449
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 792

ENDDEFINE

DEFINE CLASS forregistros AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Container1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdconsulta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtvogdg" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtigv" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txttotal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdlimpia" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column9.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column13.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column14.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column14.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column15.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column15.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column16.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column16.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column17.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column17.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column18.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column18.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdvistaprevia" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdimprimir" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcerraro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtserie" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkserie" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chktipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcontado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcredito" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtexonerado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txttpercepcion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Manyheader1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkdcto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmbdcto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdejecutar1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdaexcel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdbloqueo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtlocalizador1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Optbusqueda1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmbtipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmbmes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmbaño" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: actualiza
		*m: opciones
		*m: opcionesb
		*p: totreg
		*p: xopcion
		*p: xtipo
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 1
	BufferMode = 0
	Caption = "<REGISTRO DE COMPRAS>"
	Closable = .T.
	ControlBox = .T.
	DataSession = 2
	DoCreate = .T.
	Height = 555
	Icon = ..\graphics\anular.ico
	MaxButton = .F.
	MinButton = .T.
	Movable = .T.
	Name = "FORREGISTROS"
	Picture = ..\graphics\fondoazul.jpg
	ShowWindow = 1
	Themes = .F.
	Width = 973
	WindowState = 0
	WindowType = 0
	xopcion = 
	xtipo = 

	ADD OBJECT 'chkdcto' AS checkbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		Caption = "Tipo Dcto:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 223, ;
		Name = "chkdcto", ;
		SpecialEffect = 1, ;
		TabIndex = 14, ;
		Top = 8, ;
		Width = 75
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'chkserie' AS checkbox WITH ;
		Alignment = 0, ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Caption = "Serie:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 167, ;
		Name = "chkserie", ;
		SpecialEffect = 1, ;
		TabIndex = 4, ;
		Top = 8, ;
		Width = 51
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'chktipo' AS checkbox WITH ;
		Alignment = 0, ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Caption = "Solamente", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 14, ;
		Name = "chktipo", ;
		SpecialEffect = 1, ;
		TabIndex = 2, ;
		Top = 8, ;
		Width = 85
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'Cmbaño' AS cmbaño WITH ;
		Height = 24, ;
		Left = 532, ;
		Name = "Cmbaño", ;
		TabIndex = 7, ;
		Top = 24, ;
		Width = 85
		*< END OBJECT: ClassLib="..\..\librerias\ple.vcx" BaseClass="combobox" />

	ADD OBJECT 'cmbdcto' AS combobox WITH ;
		BorderColor = 192,192,192, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 220, ;
		Name = "cmbdcto", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		SpecialEffect = 1, ;
		Style = 2, ;
		TabIndex = 17, ;
		Top = 25, ;
		Width = 159
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Cmbmes' AS cmbmes WITH ;
		Height = 24, ;
		Left = 384, ;
		Name = "Cmbmes", ;
		TabIndex = 6, ;
		Top = 24, ;
		Width = 149
		*< END OBJECT: ClassLib="..\..\librerias\ple.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cmbtipo' AS cmbtipobien WITH ;
		Height = 24, ;
		Left = 13, ;
		Name = "Cmbtipo", ;
		TabIndex = 3, ;
		Top = 24, ;
		Width = 153
		*< END OBJECT: ClassLib="..\..\librerias\ple.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cmdaexcel' AS cmdaexcel WITH ;
		calias = registro, ;
		cgriddata = thisform.grimodelos, ;
		Height = 39, ;
		Left = 397, ;
		Name = "Cmdaexcel", ;
		TabIndex = 35, ;
		Top = 523, ;
		Visible = .F., ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\salidas.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdbloqueo1' AS cmdbloqueo WITH ;
		FontBold = .T., ;
		Height = 39, ;
		Left = 229, ;
		Name = "Cmdbloqueo1", ;
		Picture = , ;
		TabIndex = 36, ;
		Top = 511, ;
		Width = 74
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcerraro' AS cmdcerraro WITH ;
		Caption = "\<Retornar", ;
		FontBold = .T., ;
		FontSize = 8, ;
		Height = 39, ;
		Left = 304, ;
		Name = "Cmdcerraro", ;
		Picture = , ;
		TabIndex = 28, ;
		Top = 511, ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdconsulta' AS commandbutton WITH ;
		Caption = "Ver", ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 46, ;
		Left = 624, ;
		Name = "cmdconsulta", ;
		Picture = ..\graphics\find.bmp, ;
		TabIndex = 8, ;
		Top = 6, ;
		Visible = .T., ;
		Width = 54
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Cmdejecutar1' AS cmdejecutar WITH ;
		Caption = "Generar", ;
		FontBold = .T., ;
		Height = 39, ;
		Left = 156, ;
		Name = "Cmdejecutar1", ;
		Picture = ..\graphics\load.bmp, ;
		TabIndex = 34, ;
		Top = 511, ;
		Width = 74
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdimprimir' AS cmdimprimir WITH ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontSize = 8, ;
		Height = 39, ;
		Left = 81, ;
		Name = "Cmdimprimir", ;
		Picture = , ;
		TabIndex = 27, ;
		Top = 511, ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdlimpia' AS commandbutton WITH ;
		Caption = "limpia", ;
		Height = 22, ;
		Left = 264, ;
		Name = "cmdlimpia", ;
		TabIndex = 11, ;
		Top = 288, ;
		Visible = .F., ;
		Width = 73
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Cmdvistaprevia' AS cmdvistaprevia WITH ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontSize = 8, ;
		Height = 39, ;
		Left = 6, ;
		Name = "Cmdvistaprevia", ;
		Picture = , ;
		TabIndex = 26, ;
		Top = 511, ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Container1' AS container WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		BorderColor = 255,255,255, ;
		Height = 52, ;
		Left = 6, ;
		Name = "Container1", ;
		TabIndex = 9, ;
		Top = 2, ;
		Width = 678
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'grimodelos' AS grid WITH ;
		AllowHeaderSizing = .T., ;
		AllowRowSizing = .T., ;
		BackColor = 234,234,234, ;
		ColumnCount = 18, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		GridLineColor = 128,128,128, ;
		HeaderHeight = 52, ;
		Height = 411, ;
		HighlightBackColor = 0,0,0, ;
		HighlightForeColor = 255,255,255, ;
		HighlightStyle = 1, ;
		Left = 4, ;
		LockColumns = 5, ;
		LockColumnsLeft = 0, ;
		Name = "grimodelos", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RecordSource = "", ;
		RecordSourceType = 1, ;
		RowHeight = 20, ;
		ScrollBars = 3, ;
		TabIndex = 10, ;
		Top = 95, ;
		Width = 962, ;
		Column1.BackColor = 234,234,234, ;
		Column1.ControlSource = "", ;
		Column1.CurrentControl = "Text1", ;
		Column1.FontName = "Tahoma", ;
		Column1.FontSize = 8, ;
		Column1.Movable = .F., ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Resizable = .T., ;
		Column1.Width = 44, ;
		Column2.BackColor = 234,234,234, ;
		Column2.ControlSource = "", ;
		Column2.FontName = "Tahoma", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Resizable = .T., ;
		Column2.Width = 72, ;
		Column3.BackColor = 234,234,234, ;
		Column3.ControlSource = "", ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Resizable = .T., ;
		Column3.Width = 57, ;
		Column4.BackColor = 234,234,234, ;
		Column4.ControlSource = "", ;
		Column4.FontName = "Tahoma", ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Resizable = .T., ;
		Column4.Width = 48, ;
		Column5.BackColor = 234,234,234, ;
		Column5.ControlSource = "", ;
		Column5.FontName = "Tahoma", ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Resizable = .T., ;
		Column5.Width = 40, ;
		Column6.BackColor = 234,234,234, ;
		Column6.ControlSource = "", ;
		Column6.FontName = "Tahoma", ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Resizable = .T., ;
		Column6.Width = 68, ;
		Column7.BackColor = 234,234,234, ;
		Column7.ControlSource = "", ;
		Column7.FontName = "Tahoma", ;
		Column7.FontSize = 8, ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T., ;
		Column7.Resizable = .T., ;
		Column7.Width = 87, ;
		Column8.BackColor = 234,234,234, ;
		Column8.ControlSource = "", ;
		Column8.FontName = "Tahoma", ;
		Column8.FontSize = 8, ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Resizable = .T., ;
		Column8.Width = 225, ;
		Column9.BackColor = 234,234,234, ;
		Column9.ControlSource = "", ;
		Column9.FontName = "Tahoma", ;
		Column9.FontSize = 8, ;
		Column9.Format = "99,999,999.99", ;
		Column9.InputMask = "99,999,999.99", ;
		Column9.Name = "Column9", ;
		Column9.ReadOnly = .T., ;
		Column9.Resizable = .T., ;
		Column9.Width = 91, ;
		Column10.BackColor = 234,234,234, ;
		Column10.ControlSource = "", ;
		Column10.FontName = "Tahoma", ;
		Column10.FontSize = 8, ;
		Column10.Format = "99,999,999.99", ;
		Column10.InputMask = "99,999,999.99", ;
		Column10.Name = "Column10", ;
		Column10.ReadOnly = .T., ;
		Column10.Resizable = .T., ;
		Column10.Width = 70, ;
		Column11.BackColor = 234,234,234, ;
		Column11.ControlSource = "", ;
		Column11.FontName = "Tahoma", ;
		Column11.FontSize = 8, ;
		Column11.Format = "99,999,999.99", ;
		Column11.InputMask = "99,999,999.99", ;
		Column11.Name = "Column11", ;
		Column11.ReadOnly = .T., ;
		Column11.Resizable = .T., ;
		Column11.Width = 60, ;
		Column12.BackColor = 234,234,234, ;
		Column12.FontName = "Tahoma", ;
		Column12.FontSize = 8, ;
		Column12.Format = "99,999,999.99", ;
		Column12.InputMask = "99,999,999.99", ;
		Column12.Name = "Column12", ;
		Column12.ReadOnly = .T., ;
		Column12.Resizable = .T., ;
		Column12.Width = 91, ;
		Column13.BackColor = 234,234,234, ;
		Column13.FontName = "Tahoma", ;
		Column13.FontSize = 8, ;
		Column13.InputMask = "999,999.99", ;
		Column13.Name = "Column13", ;
		Column13.ReadOnly = .T., ;
		Column13.Width = 70, ;
		Column14.BackColor = 234,234,234, ;
		Column14.FontName = "Tahoma", ;
		Column14.FontSize = 8, ;
		Column14.Name = "Column14", ;
		Column14.ReadOnly = .T., ;
		Column14.Width = 249, ;
		Column15.BackColor = 233,233,233, ;
		Column15.FontName = "Tahoma", ;
		Column15.FontSize = 8, ;
		Column15.Name = "Column15", ;
		Column15.ReadOnly = .T., ;
		Column15.Width = 66, ;
		Column16.BackColor = 234,234,234, ;
		Column16.FontName = "Tahoma", ;
		Column16.FontSize = 8, ;
		Column16.Name = "Column16", ;
		Column16.ReadOnly = .T., ;
		Column16.Width = 120, ;
		Column17.BackColor = 234,234,234, ;
		Column17.FontName = "Tahoma", ;
		Column17.FontSize = 8, ;
		Column17.Name = "Column17", ;
		Column17.ReadOnly = .T., ;
		Column17.Width = 85, ;
		Column18.BackColor = 234,234,234, ;
		Column18.FontName = "Tahoma", ;
		Column18.FontSize = 8, ;
		Column18.Name = "Column18", ;
		Column18.ReadOnly = .T., ;
		Column18.Width = 89
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'grimodelos.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Forma", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column1.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column10.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Exonerado", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column10.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column11.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "IGV", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column11.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column12.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Total", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column12.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column13.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Percepción", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column13.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column14.Header1' AS header WITH ;
		BackColor = 187,193,247, ;
		Caption = "Detalle", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column14.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column15.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Tipo Cambio", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column15.Text1' AS textbox WITH ;
		BackColor = 233,233,233, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column16.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Número", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column16.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column17.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Fecha de Emisión", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column17.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column18.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Monto Detraccíon", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column18.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Fe_Registro", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column2.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Fe_Docto", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column3.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Tipo Dcto", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column4.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Serie", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column5.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Número", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column6.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Ruc", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column7.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column8.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Razón Social", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column8.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column9.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Base Imponible", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column9.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Label1' AS label WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Caption = "Año:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 542, ;
		Name = "Label1", ;
		TabIndex = 24, ;
		Top = 8, ;
		Width = 28
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Caption = "Mes:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 385, ;
		Name = "Label2", ;
		TabIndex = 25, ;
		Top = 8, ;
		Width = 33
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Contado", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 17, ;
		Left = 756, ;
		Name = "Label3", ;
		TabIndex = 29, ;
		Top = 6, ;
		Width = 59
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Valor Gravado", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 484, ;
		Name = "Label4", ;
		TabIndex = 12, ;
		Top = 510, ;
		Width = 83
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Crédito", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 17, ;
		Left = 875, ;
		Name = "Label5", ;
		TabIndex = 30, ;
		Top = 6, ;
		Width = 48
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		Alignment = 2, ;
		BackStyle = 0, ;
		Caption = "IGV Gravado", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 670, ;
		Name = "Label6", ;
		TabIndex = 15, ;
		Top = 510, ;
		Width = 73
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		Alignment = 2, ;
		BackStyle = 0, ;
		Caption = "Importe Total", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 760, ;
		Name = "Label7", ;
		TabIndex = 18, ;
		Top = 510, ;
		Width = 90
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label8' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Exonerado", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 576, ;
		Name = "Label8", ;
		TabIndex = 13, ;
		Top = 510, ;
		Width = 83
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label9' AS label WITH ;
		Alignment = 2, ;
		BackStyle = 0, ;
		Caption = "Total Percepsión:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 850, ;
		Name = "Label9", ;
		TabIndex = 16, ;
		Top = 510, ;
		Width = 103
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Manyheader1' AS manyheader WITH ;
		Left = 132, ;
		Name = "Manyheader1", ;
		TabIndex = 33, ;
		Top = 144
		*< END OBJECT: ClassLib="..\libs\gridex.vcx" BaseClass="container" />

	ADD OBJECT 'Optbusqueda1' AS optbusqueda WITH ;
		BackStyle = 0, ;
		Height = 22, ;
		Left = 11, ;
		Name = "Optbusqueda1", ;
		TabIndex = 37, ;
		Top = 69, ;
		Width = 220, ;
		optdescripcion.BackStyle = 0, ;
		optdescripcion.Caption = "Razón Social", ;
		optdescripcion.FontName = "Tahoma", ;
		optdescripcion.FontSize = 8, ;
		optdescripcion.Left = 7, ;
		optdescripcion.Name = "optdescripcion", ;
		optdescripcion.Top = 5, ;
		optcodigo.BackStyle = 0, ;
		optcodigo.Caption = "No Documento", ;
		optcodigo.FontName = "Tahoma", ;
		optcodigo.FontSize = 8, ;
		optcodigo.Height = 17, ;
		optcodigo.Left = 112, ;
		optcodigo.Name = "optcodigo", ;
		optcodigo.Top = 5, ;
		optcodigo.Width = 103
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'txtcontado' AS textbox WITH ;
		Alignment = 3, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "9,999,999.99", ;
		Height = 25, ;
		InputMask = "9,999,999.99", ;
		Left = 738, ;
		Name = "txtcontado", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 31, ;
		Top = 24, ;
		Value = 0, ;
		Width = 101
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtcredito' AS textbox WITH ;
		Alignment = 3, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "9,999,999.99", ;
		Height = 25, ;
		InputMask = "9,999,999.99", ;
		Left = 840, ;
		Name = "txtcredito", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 32, ;
		Top = 24, ;
		Value = 0, ;
		Width = 105
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtexonerado' AS textbox WITH ;
		Alignment = 3, ;
		BackColor = 192,192,192, ;
		BorderStyle = 1, ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Format = "R", ;
		Height = 22, ;
		InputMask = "999,999.99", ;
		Left = 574, ;
		Name = "txtexonerado", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 19, ;
		Top = 528, ;
		Value = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtigv' AS textbox WITH ;
		Alignment = 3, ;
		BackColor = 192,192,192, ;
		BorderStyle = 1, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Format = "R", ;
		Height = 22, ;
		InputMask = "9,999,999.99", ;
		Left = 666, ;
		Name = "txtigv", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 21, ;
		Top = 528, ;
		Value = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Txtlocalizador1' AS txtlocalizador WITH ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 20, ;
		Left = 236, ;
		Name = "Txtlocalizador1", ;
		TabIndex = 1, ;
		Top = 71, ;
		Width = 221
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtserie' AS textbox WITH ;
		BorderColor = 192,192,192, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 166, ;
		MaxLength = 3, ;
		Name = "txtserie", ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 5, ;
		Top = 25, ;
		Width = 51
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txttotal' AS textbox WITH ;
		Alignment = 3, ;
		BackColor = 192,192,192, ;
		BorderStyle = 1, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Format = "R", ;
		Height = 23, ;
		InputMask = "9,999,999.99", ;
		Left = 759, ;
		Name = "txttotal", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 22, ;
		Top = 528, ;
		Value = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txttpercepcion' AS textbox WITH ;
		Alignment = 3, ;
		BackColor = 192,192,192, ;
		BorderStyle = 1, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Format = "R", ;
		Height = 23, ;
		InputMask = "9,999,999.99", ;
		Left = 852, ;
		Name = "txttpercepcion", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 23, ;
		Top = 528, ;
		Value = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtvogdg' AS textbox WITH ;
		Alignment = 3, ;
		BackColor = 192,192,192, ;
		BorderStyle = 1, ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Format = "R", ;
		Height = 22, ;
		InputMask = "9,999,999.99", ;
		Left = 482, ;
		Name = "txtvogdg", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 20, ;
		Top = 528, ;
		Value = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE actualiza
		*DO FORM co_redondeo WITH registro.serie+registro.ndoc,registro.tdoc,;
		registro.mone,registro.fecr,registro.dola,iif(registro.igvg=0,registro.exon,registro.valorg),;
		registro.igvg,registro.importe,codigo,thisform.xopcion,registro.fech 
		*thisform.cmdconsulta.click()
		
	ENDPROC

	PROCEDURE Init
		Lparameters xopcion,xtipo
		Settear()
		If datosGlobales()=0 Then
			Return .F.
		Endif
		If MuestraDctos1("",'l1')=0 Then
			Return .F.
		Endif
		Thisform.cmbdcto.RowSource="l1.nomb"
		Thisform.cmbdcto.ListIndex=1
		With This
			.xopcion=xopcion
			This.manyheader1.initheader(Thisform.grimodelos)
			This.manyheader1.mergeheader(4,6,"No Comprobante")
			This.manyheader1.mergeheader(7,8,"Datos del Proveedor")
			This.manyheader1.mergeheader(16,18,"Constancia de Depósito de Detracción")
		    .chkserie.Visible=.F.
			.txtserie.Visible=.F.
			.cmbtipo.ListIndex=1
			.cmbmes.ListIndex=Month(Date())
			.cmbaño.Value=Str(Year(Date()))
		Endwith
		
	ENDPROC

	PROCEDURE opciones
		Lparameters opt
		If opt=1 Then
			Thisform.cmdaexcel.Click()
		Else
			Try
				Set Procedure To capadatos,ple5 Additive
				cf=Getfile('TXT',"Nombre:",'Nombre',1,"Elija Una Ubicación Para Guardar el Archivo")
				cr=Upper("LE"+Alltrim(fe_gene.nruc)+Alltrim(Thisform.cmbaño.Value)+Iif(Thisform.cmbmes.ListIndex<=9,'0'+Alltrim(Str(Thisform.cmbmes.ListIndex)),Alltrim(Str(Thisform.cmbmes.ListIndex))))+"00080100001111"
				nmes=Thisform.cmbmes.ListIndex
				na=Val(Thisform.cmbaño.Value)
			    GeneraPLE5Compras(cf,cr,nmes,na)
				cruta=Addbs(Justpath(cf))+cr
				Messagebox("Se Genero el Archivo:"+cruta+" Correctamente",64,MSGTITULO)
				cr=Upper("LE"+Alltrim(fe_gene.nruc)+Alltrim(Thisform.cmbaño.Value)+Iif(Thisform.cmbmes.ListIndex<=9,'0'+Alltrim(Str(Thisform.cmbmes.ListIndex)),Alltrim(Str(Thisform.cmbmes.ListIndex))))+"00080200001011"
				GeneraPLE5Compras1(cf,cr,nmes,na)
				Messagebox("Se Genero el Archivo 2 :"+cruta+" Correctamente",64,MSGTITULO)
			Catch To oerror
				Messagebox("No se Genero El Archivo de Envio Correspondiente",16,MSGTITULO)
			Endtry
		Endif
		
	ENDPROC

	PROCEDURE opcionesb
		Lparameters opt
		Set Procedure To capadatos Additive
		If opt=1 Then
			If BloqueaD(Thisform.cmbmes.ListIndex,Val(Thisform.cmbaño.Value),0)=1 Then
				Messagebox("Se Bloqueo Correctamente",64,MSGTITULO)
			Endif
		Else
			Do Form V_verifica With 'A' To verdad
			If !verdad
				Return
			Endif
			If BloqueaD(Thisform.cmbmes.ListIndex,Val(Thisform.cmbaño.Value),1)=1 Then
				Messagebox("Se Desbloqueo Correctamente",64,MSGTITULO)
			Endif
		Endif
		
	ENDPROC

	PROCEDURE Cmdaexcel.Click
		If VerificaAlias("registro")=1 Then
			If Thisform.xtipo='V' Then
				This.titulo1="Registro de Ventas Período:"+Alltrim(Thisform.cmbmes.Value)+'-'+Alltrim(Thisform.cmbaño.Value)
			Else
				This.titulo1="Registro de Compras Período:"+Alltrim(Thisform.cmbmes.Value)+'-'+Alltrim(Thisform.cmbaño.Value)
			Endif
			DoDefault()
		Endif
		
	ENDPROC

	PROCEDURE Cmdcerraro.Click
		*CierraCursor("registro")
		*CierraCursor("facturas")
		*CierraCursor("boletas")
		DODEFAULT()   
	ENDPROC

	PROCEDURE cmdconsulta.Click
		Local lwhere,lfiltro,lboletas,lwboletas,anulada,lfiltro1
		Store 0 To x,nvalorp,nexon,nigvp,nimportep,nfilas,totreg
		anulada=""
		Thisform.grimodelos.RecordSource=""
		Thisform.cmdlimpia.Click()
		nmes=Thisform.cmbmes.ListIndex
		na=Val(Thisform.cmbaño.Value)
		cguia='09'
		If Thisform.chktipo.Value=1
			ctmvto=Left(Thisform.cmbtipo.Value,1)
			TEXT TO consulta NOSHOW TEXTMERGE
			            a.form,a.fecr,a.fech,a.tdoc,IF(LENGTH(TRIM(a.ndoc))<=10,LEFT(a.ndoc,3),LEFT(a.ndoc,4)) AS serie,
						IF(LENGTH(TRIM(a.ndoc))<=10,MID(a.ndoc,4,7),MID(a.ndoc,5,8)) AS ndoc,b.nruc,b.razo,c.v1,c.v2,c.v3,c.v4,c.igv,c.exon,c.otros,c.impo,
						a.pimpo,a.mone,a.dolar AS dola,a.rcom_detr,a.rcom_fecd,IF(a.valor<>0,ROUND(x.igv,2),1) AS vigv,a.idprov AS codigo,
						IFNULL(a.deta,'')  AS detalle,a.idauto,tipom AS tipo,rcom_icbper
						FROM fe_rcom AS a  INNER JOIN
						(SELECT a.idauto,SUM(CASE c.nitem WHEN 1 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v1,
						SUM(CASE c.nitem WHEN 2 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v2,
						SUM(CASE c.nitem WHEN 3 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v3,
						SUM(CASE c.nitem WHEN 4 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v4,
						SUM(CASE c.nitem WHEN 5 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS igv,
						SUM(CASE c.nitem WHEN 6 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS exon,
						SUM(CASE c.nitem WHEN 7 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS Otros,
						SUM(CASE c.nitem WHEN 8 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS impo
						FROM fe_rcom AS a  INNER JOIN fe_ectasc AS c ON(c.idrcon=a.idauto)
						WHERE  MONTH(fecr)=<<nmes>> and YEAR(fecr)=<<na>>  AND tdoc NOT IN ('09','II')  AND acti='A' AND ecta_acti='A' and a.tipom='<<ctmvto>>'
						GROUP BY idauto)
						AS c  ON(c.idauto=a.idauto) JOIN fe_prov  AS b ON(b.idprov=a.idprov),fe_gene AS x
			ENDTEXT
		Else
			TEXT TO consulta NOSHOW TEXTMERGE
					    a.form,a.fecr,a.fech,a.tdoc,IF(LENGTH(TRIM(a.ndoc))<=10,LEFT(a.ndoc,3),LEFT(a.ndoc,4)) AS serie,
						IF(LENGTH(TRIM(a.ndoc))<=10,MID(a.ndoc,4,7),MID(a.ndoc,5,8)) AS ndoc,b.nruc,b.razo,c.v1,c.v2,c.v3,c.v4,c.igv,c.exon,c.otros,c.impo,
						a.pimpo,a.mone,a.dolar AS dola,a.rcom_detr,a.rcom_fecd,IF(a.valor<>0,ROUND(x.igv,2),1) AS vigv,a.idprov AS codigo,
						IFNULL(a.deta,'')  AS detalle,a.idauto,tipom AS tipo,rcom_icbper
						FROM fe_rcom AS a  INNER JOIN
						(SELECT a.idauto,SUM(CASE c.nitem WHEN 1 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v1,
						SUM(CASE c.nitem WHEN 2 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v2,
						SUM(CASE c.nitem WHEN 3 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v3,
						SUM(CASE c.nitem WHEN 4 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS v4,
						SUM(CASE c.nitem WHEN 5 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS igv,
						SUM(CASE c.nitem WHEN 6 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS exon,
						SUM(CASE c.nitem WHEN 7 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS Otros,
						SUM(CASE c.nitem WHEN 8 THEN IF(a.mone='S',c.impo,ROUND(c.impo*a.dolar,2)) ELSE 0 END) AS impo
						FROM fe_rcom AS a  INNER JOIN fe_ectasc AS c ON(c.idrcon=a.idauto)
						WHERE  MONTH(fecr)=<<nmes>> and YEAR(fecr)=<<na>>  AND tdoc NOT IN ('09','II')  AND acti='A' AND ecta_acti='A' GROUP BY idauto)
						AS c  ON(c.idauto=a.idauto) JOIN fe_prov  AS b ON(b.idprov=a.idprov),fe_gene AS x
			ENDTEXT
		Endif
		If EjecutaConsulta(consulta,'registro') < 1
			Return
		Endif
		nfilas=fe_gene.lrcom
		Select Form,fecr,fech,tdoc,serie,ndoc,nruc,razo,Round(v1+v2+v3+v4,2) As valorg,;
			exon,igv As igvg,otros,Impo As importe,Iif(mone="D",Round(pimpo*dola,2),pimpo) As pimpo,detalle,rcom_detr,rcom_fecd,mone,dola,codigo,'' As ndni,idauto,tipo;
			From registro Into Cursor registro1 Order By fech,idauto
		If Thisform.chkdcto.Value=1 Then
			ctdoc=l1.tdoc
			Select * From registro1 Where tdoc=ctdoc Into Cursor registro1
		Endif
		Create Cursor registro(Form c(1) Null,fecr d Null,fech d Null,tdoc c(2) Null,serie c(4),ndoc c(8),nruc c(11)Null,razo c(40)Null,valorg N(14,2),exon N(12,2),;
			igvg N(10,2),importe N(14,2),pimpo N(8,2),detalle c(50),dola N(5,3),detra c(24),fechad d,mone c(1),codigo N(5),fechn d,tref c(2),Refe c(10),fevto d,Auto N(15),;
			ndni c(8),T N(1),tipo c(1),icbper N(8,2),otros N(8,2))
		x=1
		notas=0
		
		
		
		TEXT TO lc NOSHOW TEXTMERGE PRETEXT 7
			a.ndoc,a.tdoc,a.fech,b.ncre_idnc AS idn,ncre_idan  FROM (
			SELECT ncre_idnc,ncre_idau,ncre_idan FROM fe_nccom AS n INNER JOIN fe_rcom AS r
			ON r.idauto=n.`ncre_idan` WHERE MONTH(r.fecr)=<<nmes>> and YEAR(r.fecr)=<<na>>  AND r.acti='A' AND  ncre_acti='A' ) AS b  INNER JOIN  fe_rcom AS a ON a.idauto=b.ncre_idau
		ENDTEXT
		If EjecutaConsulta(lc,'xnotas')<1 Then
			Return
		Endif
		
		
		Select registro1
		Go Top
		Do While !Eof()
		*	If x<nfilas
			nidn=registro1.idauto
			ntdoc='00'
			nndoc='            '
			nfech=Ctod("  /  /    ")
			If registro1.tdoc='07' Or registro1.tdoc='08' Then
				nauto=registro1.idauto
				TEXT TO lc NOSHOW TEXTMERGE
					       a.ndoc,a.tdoc,a.fech,b.ncre_idnc as idn FROM (
					       select ncre_idnc,ncre_idau FROM fe_nccom WHERE ncre_idan=<<nauto>> and ncre_acti='A' group by ncre_idau,ncre_idnc)as b
					       INNER JOIN  fe_rcom as a on a.idauto=b.ncre_idau
				ENDTEXT
		*If EjecutaConsulta(lc,'xn')<1 Then
		*	errorbd(lc+' Consultando las Referencias de las Notas de Crédito/Debito')
		*	Exit
		*Endif
				Select * From xnotas Where ncre_idan=nauto Into Cursor xn
				notas=1
				nidn=xn.idn
				ntdoc=xn.tdoc
				nndoc=xn.ndoc
				nfech=xn.fech
			Endif
			Insert Into registro(Form,fecr,fech,tdoc,serie,ndoc,nruc,razo,valorg,igvg,exon,importe,pimpo,detalle,mone,dola,detra,fechad,codigo,Auto,ndni,T,tref,Refe,fechn,tipo);
				values(registro1.Form,registro1.fecr,registro1.fech,registro1.tdoc,registro1.serie,registro1.ndoc,;
				registro1.nruc,registro1.razo,registro1.valorg,registro1.igvg,registro1.exon,registro1.importe,registro1.pimpo,registro1.detalle,;
				registro1.mone,registro1.dola,registro1.rcom_detr,Iif(Isnull(registro1.rcom_fecd),Ctod("  /  /    "),registro1.rcom_fecd),registro1.codigo,;
				registro1.idauto,registro1.ndni,Iif(tdoc='03',1,6),ntdoc,nndoc,nfech,registro1.tipo)
			If notas=1 Then
				Y=1
				Select xn
				Scan All
					If Y>1 Then
						Insert Into registro(Form,fecr,fech,tdoc,serie,ndoc,nruc,razo,Auto,ndni,tref,Refe,fechn,tipo);
							values(registro1.Form,registro1.fecr,registro1.fech,registro1.tdoc,registro1.serie,registro1.ndoc,;
							registro1.nruc,registro1.razo,xn.idn,registro1.ndni,xn.tdoc,xn.ndoc,xn.fech,registro1.tipo)
						x=x+1
						totreg=totreg+1
					Endif
					Y=Y+1
				Endscan
				notas=0
			Endif
			Select registro1
			x=x+1
			totreg=totreg+1
			nvalorp=nvalorp+registro1.valorg
			nexon=nexon+registro1.exon
			nigvp=nigvp+registro1.igvg
			nimportep=nimportep+registro1.importe
			If Form="E"
				Thisform.txtcontado.Value=Thisform.txtcontado.Value+importe
			Else
				Thisform.txtcredito.Value=Thisform.txtcredito.Value+importe
			Endif
		*	Else
		*		Skip -1
		*	Insert Into registro(serie,ndoc,nruc,razo,valorg,exon,igvg,importe);
		values(registro1.serie,"-------","Van","-----------------",nvalorp,nexon,nigvp,nimportep)
		*	Insert Into registro(serie,ndoc,nruc,razo,valorg,exon,igvg,importe);
		values(registro1.serie,"-------","Vienen","-----------------",nvalorp,nexon,nigvp,nimportep)
		*	x=2
		*Endif
			Skip
		Enddo
		Select Sum(valorg) As tvg,Sum(exon) As tex,Sum(igvg) As tigv,Sum(importe) As timpo,Sum(pimpo) As tpimpo From registro Where serie<>'---' And ndoc<>'-------';
			into Cursor lx
		Thisform.txtvogdg.Value=lx.tvg
		Thisform.txtexonerado.Value=lx.tex
		Thisform.txtigv.Value=lx.tigv
		Thisform.txttotal.Value=lx.timpo
		Thisform.txttpercepcion.Value=lx.tpimpo
		Thisform.totreg=totreg
		Select * From registro Into Cursor creg
		Select registro
		Go Top
		Thisform.grimodelos.RecordSource="registro"
		Thisform.grimodelos.Refresh
		Thisform.grimodelos.SetFocus
		
		
	ENDPROC

	PROCEDURE Cmdejecutar1.Click
		Set Shadow On
		Define Popup GridPopup ;
			FROM Mrow(), Mcol() ;
			MARGIN ;
			SHORTCUT
		Define Bar 1 Of GridPopup Prompt "Exportar a Excel        "
		Define Bar 2 Of GridPopup Prompt "Generar Arvhivo de Envio"
		On Selection Popup GridPopup _Screen.ActiveForm.opciones(Bar())
		Activate Popup GridPopup
		Release Popup GridPopup
		
	ENDPROC

	PROCEDURE Cmdimprimir.Click
		If verificaAlias("registro")=1 Then
			Report Form co_rcompras To Printer Prompt Noconsole
		Endif
		
	ENDPROC

	PROCEDURE cmdlimpia.Click
		With Thisform
			.txtvogdg.Value=0
			.txtexonerado.Value=0
			.txtigv.Value=0
			.txttotal.Value=0
			.txtcontado.Value=0
			.txtcredito.Value=0
		Endwith
		
	ENDPROC

	PROCEDURE Cmdvistaprevia.Click
		If verificaAlias("registro")=1 Then
			Select registro
			Report Form co_rcompras Preview
		Endif
		
	ENDPROC

	PROCEDURE grimodelos.Column1.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column10.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column11.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column2.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column3.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column4.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column5.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column6.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column7.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column8.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE grimodelos.Column9.Text1.DblClick
		thisform.actualiza()
	ENDPROC

	PROCEDURE Txtlocalizador1.InteractiveChange
		Local cvalor
		If verificaAlias("registro")=1 Then
			Thisform.grimodelos.RecordSource=""
			cvalor='%'+Alltrim(This.Value)+'%'
			If Thisform.optbusqueda1.optcodigo.Value=1 Then
				Select * From creg Where ndoc Like cvalor Into Cursor registro 
			Else
				Select * From creg Where razo Like cvalor Into Cursor registro 
			Endif
			Thisform.grimodelos.RecordSource="registro"
			Thisform.grimodelos.Refresh
		Endif
		
		
		
	ENDPROC

	PROCEDURE Txtlocalizador1.LostFocus
		thisform.grimodelos.SetFocus 
	ENDPROC

	PROCEDURE txtserie.LostFocus
		this.value=right("000"+alltrim(this.value),3)
	ENDPROC

ENDDEFINE
