*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ka_canjes.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 480
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 792

ENDDEFINE

DEFINE CLASS forcanjes AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Pgf1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.grimodelos.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.txttotal1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.SHAPE11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.Cmdconsulta1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.Txtfechainicial" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.Txtfechafinal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page1.cmdeliminar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.txttotal2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.Cmdcerraro1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.Cmdaceptar1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.txtitems" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.grimodelos.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page2.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Txtfechainicial" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Txtfechafinal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Cmdcal1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Cmdcal2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Cmdconsulta1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column12.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column12.cmdver" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.grimodelos.Column2.Cmdeditar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgf1.Page3.Label1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: suma
		*p: calma
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BackColor = 214,232,255
	BorderStyle = 1
	Caption = "[Canjes de Notas de Ventas Por Boletas/Facturas]"
	ControlBox = .T.
	DataSession = 2
	DoCreate = .T.
	FontName = "Tahoma"
	Height = 571
	Icon = ..\graphics\59.ico
	MaxButton = .F.
	MinButton = .T.
	Name = "forcanjes"
	ShowWindow = 1
	Width = 904
	WindowState = 0
	WindowType = 0

	ADD OBJECT 'Pgf1' AS pgf WITH ;
		ErasePage = .T., ;
		Height = 553, ;
		Left = 3, ;
		Name = "Pgf1", ;
		PageCount = 3, ;
		Themes = .F., ;
		Top = 7, ;
		Width = 885, ;
		Page1.BackColor = 214,232,255, ;
		Page1.Caption = "1. Listar las Ventas ", ;
		Page1.FontBold = .T., ;
		Page1.FontName = "Tahoma", ;
		Page1.FontSize = 8, ;
		Page1.Name = "Page1", ;
		Page1.Picture = ..\, ;
		Page2.BackColor = 214,232,255, ;
		Page2.Caption = "2. Ver Lista Seleccionada", ;
		Page2.FontBold = .T., ;
		Page2.FontName = "Tahoma", ;
		Page2.FontSize = 8, ;
		Page2.Name = "Page2", ;
		Page2.Picture = ..\, ;
		Page3.BackColor = 214,232,255, ;
		Page3.Caption = "Lista de Canjes", ;
		Page3.FontBold = .T., ;
		Page3.FontName = "Tahoma", ;
		Page3.FontSize = 8, ;
		Page3.Name = "Page3"
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="pageframe" />

	ADD OBJECT 'Pgf1.Page1.Cmdconsulta1' AS cmdconsulta WITH ;
		Height = 36, ;
		Left = 254, ;
		Name = "Cmdconsulta1", ;
		TabIndex = 3, ;
		Top = 13, ;
		Width = 91
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page1.cmdeliminar' AS commandbutton WITH ;
		BackColor = 249,180,147, ;
		Caption = "\<Borrar Item", ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 18, ;
		Name = "cmdeliminar", ;
		Picture = ..\graphics\borrar.bmp, ;
		PicturePosition = 0, ;
		TabIndex = 55, ;
		Top = 478, ;
		Width = 102, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page1.grimodelos' AS grid WITH ;
		BackColor = 224,224,224, ;
		ColumnCount = 8, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		HeaderHeight = 28, ;
		Height = 416, ;
		HighlightBackColor = 0,255,128, ;
		HighlightForeColor = 0,0,0, ;
		HighlightStyle = 1, ;
		Left = 16, ;
		Name = "grimodelos", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RowHeight = 16, ;
		ScrollBars = 2, ;
		TabIndex = 7, ;
		Themes = .F., ;
		Top = 55, ;
		Width = 855, ;
		Column1.BackColor = 224,224,224, ;
		Column1.FontName = "Tahoma", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 78, ;
		Column2.BackColor = 224,224,224, ;
		Column2.FontName = "Tahoma", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 349, ;
		Column3.BackColor = 224,224,224, ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 8, ;
		Column3.Format = "", ;
		Column3.InputMask = "", ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 96, ;
		Column4.BackColor = 224,224,224, ;
		Column4.FontName = "Tahoma", ;
		Column4.FontSize = 8, ;
		Column4.Format = "99,999.99", ;
		Column4.InputMask = "99,999.99", ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 109, ;
		Column5.BackColor = 224,224,224, ;
		Column5.FontName = "Tahoma", ;
		Column5.FontSize = 8, ;
		Column5.Format = "99,999.99", ;
		Column5.InputMask = "99,999.99", ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .F., ;
		Column5.Width = 82, ;
		Column6.BackColor = 224,224,224, ;
		Column6.FontName = "Tahoma", ;
		Column6.FontSize = 8, ;
		Column6.Format = "999,999.99", ;
		Column6.InputMask = "999,999.99", ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 104, ;
		Column7.BackColor = 224,224,224, ;
		Column7.FontName = "Tahoma", ;
		Column7.FontSize = 8, ;
		Column7.ForeColor = 0,0,0, ;
		Column7.Format = "99,999.99", ;
		Column7.InputMask = "99,999.99", ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .F., ;
		Column7.Visible = .F., ;
		Column8.BackColor = 224,224,224, ;
		Column8.FontName = "Tahoma", ;
		Column8.FontSize = 8, ;
		Column8.Format = "999,999.99", ;
		Column8.InputMask = "999,999.99", ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Visible = .F., ;
		Column8.Width = 77
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Código", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column1.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Descripción", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column2.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Unid.", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column3.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Cantidad", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column4.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Precio Vendido", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column5.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Importe", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column6.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column7.Header1' AS header WITH ;
		BackColor = 0,128,255, ;
		Caption = "Precio_N.", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column7.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column8.Header1' AS header WITH ;
		BackColor = 0,128,255, ;
		Caption = "Importe N.", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page1.grimodelos.Column8.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.Label1' AS label WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Caption = "Fecha Inicio:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 14, ;
		Left = 30, ;
		Name = "Label1", ;
		TabIndex = 6, ;
		Top = 11, ;
		Width = 70
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page1.Label2' AS label WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Caption = "Fecha Final:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 15, ;
		Left = 140, ;
		Name = "Label2", ;
		TabIndex = 8, ;
		Top = 11, ;
		Width = 70
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page1.Label3' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Total S/.:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 696, ;
		Name = "Label3", ;
		TabIndex = 9, ;
		Top = 502, ;
		Width = 48
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page1.SHAPE11' AS shape1 WITH ;
		BackStyle = 0, ;
		Height = 42, ;
		Left = 18, ;
		Name = "SHAPE11", ;
		Top = 10, ;
		Width = 339
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="shape" />

	ADD OBJECT 'Pgf1.Page1.Txtfechafinal' AS txtfechafinal WITH ;
		Left = 138, ;
		Name = "Txtfechafinal", ;
		TabIndex = 2, ;
		Top = 26, ;
		Width = 85
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.Txtfechainicial' AS txtfechainicial WITH ;
		Left = 29, ;
		Name = "Txtfechainicial", ;
		TabIndex = 1, ;
		Top = 26, ;
		Width = 85
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page1.txttotal1' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 224,224,224, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "999,999.99", ;
		Height = 23, ;
		InputMask = "999,999.99", ;
		Left = 752, ;
		Name = "txttotal1", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 11, ;
		Top = 493, ;
		Value = 0, ;
		Width = 92
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.Cmdaceptar1' AS cmdaceptar WITH ;
		Height = 36, ;
		Left = 10, ;
		Name = "Cmdaceptar1", ;
		TabIndex = 4, ;
		Top = 485, ;
		Width = 70
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page2.Cmdcerraro1' AS cmdcerraro WITH ;
		Height = 36, ;
		Left = 79, ;
		Name = "Cmdcerraro1", ;
		TabIndex = 5, ;
		Top = 485, ;
		Width = 70
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page2.grimodelos' AS grid WITH ;
		BackColor = 224,224,224, ;
		ColumnCount = 8, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		HeaderHeight = 28, ;
		Height = 464, ;
		HighlightBackColor = 0,255,128, ;
		HighlightForeColor = 0,0,0, ;
		HighlightStyle = 1, ;
		Left = 8, ;
		Name = "grimodelos", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RowHeight = 16, ;
		ScrollBars = 2, ;
		TabIndex = 7, ;
		Themes = .F., ;
		Top = 7, ;
		Width = 855, ;
		Column1.BackColor = 224,224,224, ;
		Column1.FontName = "Tahoma", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 78, ;
		Column2.BackColor = 224,224,224, ;
		Column2.FontName = "Tahoma", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 327, ;
		Column3.BackColor = 224,224,224, ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 8, ;
		Column3.Format = "", ;
		Column3.InputMask = "", ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 96, ;
		Column4.BackColor = 224,224,224, ;
		Column4.FontName = "Tahoma", ;
		Column4.FontSize = 8, ;
		Column4.Format = "99,999.99", ;
		Column4.InputMask = "99,999.99", ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 109, ;
		Column5.BackColor = 224,224,224, ;
		Column5.FontName = "Tahoma", ;
		Column5.FontSize = 8, ;
		Column5.Format = "999,999.99", ;
		Column5.InputMask = "999,999.99", ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 82, ;
		Column6.BackColor = 224,224,224, ;
		Column6.FontName = "Tahoma", ;
		Column6.FontSize = 8, ;
		Column6.Format = "999,999.99", ;
		Column6.InputMask = "999,999.99", ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 125, ;
		Column7.BackColor = 224,224,224, ;
		Column7.FontName = "Tahoma", ;
		Column7.FontSize = 8, ;
		Column7.ForeColor = 0,0,0, ;
		Column7.Format = "99,999.99", ;
		Column7.InputMask = "99,999.99", ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .F., ;
		Column7.Visible = .F., ;
		Column8.BackColor = 224,224,224, ;
		Column8.FontName = "Tahoma", ;
		Column8.FontSize = 8, ;
		Column8.Format = "999,999.99", ;
		Column8.InputMask = "999,999.99", ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Visible = .F., ;
		Column8.Width = 77
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Código", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column1.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Descripción", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column2.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Unid.", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column3.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Cantidad", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column4.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Precio Vendido", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column5.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,128,192, ;
		Caption = "Importe", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column6.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column7.Header1' AS header WITH ;
		BackColor = 0,128,255, ;
		Caption = "Precio_N.", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column7.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column8.Header1' AS header WITH ;
		BackColor = 0,128,255, ;
		Caption = "Importe N.", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page2.grimodelos.Column8.Text1' AS textbox WITH ;
		BackColor = 224,224,224, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Total S/.:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 699, ;
		Name = "Label1", ;
		TabIndex = 10, ;
		Top = 502, ;
		Width = 54
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page2.Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Item(s):", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 563, ;
		Name = "Label4", ;
		TabIndex = 10, ;
		Top = 502, ;
		Width = 48
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page2.txtitems' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 224,224,224, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "999,999", ;
		Height = 23, ;
		InputMask = "999,999", ;
		Left = 619, ;
		Name = "txtitems", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 12, ;
		Top = 498, ;
		Value = 0, ;
		Width = 73
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page2.txttotal2' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 224,224,224, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "999,999.99", ;
		Height = 23, ;
		InputMask = "999,999.99", ;
		Left = 756, ;
		Name = "txttotal2", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 13, ;
		Top = 497, ;
		Value = 0, ;
		Width = 92
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page3.Cmdcal1' AS cmdcal WITH ;
		Height = 33, ;
		Left = 109, ;
		Name = "Cmdcal1", ;
		Top = 26, ;
		txtnombre = txtfechainicial, ;
		Width = 38
		*< END OBJECT: ClassLib="..\libs\lmcal.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page3.Cmdcal2' AS cmdcal WITH ;
		Height = 33, ;
		Left = 235, ;
		Name = "Cmdcal2", ;
		Top = 26, ;
		txtnombre = txtfechafinal, ;
		Width = 38
		*< END OBJECT: ClassLib="..\libs\lmcal.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page3.Cmdconsulta1' AS cmdconsulta WITH ;
		Height = 42, ;
		Left = 284, ;
		Name = "Cmdconsulta1", ;
		Top = 17, ;
		Width = 87
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page3.grimodelos' AS grid WITH ;
		BackColor = 234,234,234, ;
		ColumnCount = 4, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		GridLineColor = 192,192,192, ;
		HeaderHeight = 21, ;
		Height = 456, ;
		HighlightBackColor = 128,128,255, ;
		HighlightForeColor = 255,255,255, ;
		HighlightStyle = 1, ;
		Left = 20, ;
		Name = "grimodelos", ;
		Panel = 1, ;
		RecordSource = "", ;
		RowHeight = 16, ;
		ScrollBars = 0, ;
		Themes = .F., ;
		Top = 65, ;
		Width = 466, ;
		Column1.BackColor = 234,234,234, ;
		Column1.ColumnOrder = 1, ;
		Column1.ControlSource = "", ;
		Column1.FontName = "Tahoma", ;
		Column1.FontSize = 8, ;
		Column1.ForeColor = 0,0,0, ;
		Column1.Name = "Column1", ;
		Column1.Width = 162, ;
		Column2.BackColor = 234,234,234, ;
		Column2.ColumnOrder = 2, ;
		Column2.ControlSource = "", ;
		Column2.FontName = "Tahoma", ;
		Column2.FontSize = 8, ;
		Column2.ForeColor = 0,0,0, ;
		Column2.Name = "Column3", ;
		Column2.Visible = .F., ;
		Column2.Width = 99, ;
		Column3.BackColor = 234,234,234, ;
		Column3.ColumnOrder = 3, ;
		Column3.ControlSource = "", ;
		Column3.CurrentControl = "Text1", ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 8, ;
		Column3.ForeColor = 0,0,0, ;
		Column3.Name = "Column12", ;
		Column3.Sparse = .F., ;
		Column3.Visible = .F., ;
		Column3.Width = 111, ;
		Column4.BackColor = 234,234,234, ;
		Column4.CurrentControl = "Cmdeditar", ;
		Column4.FontName = "Tahoma", ;
		Column4.FontSize = 8, ;
		Column4.FontStrikethru = .T., ;
		Column4.ForeColor = 0,0,0, ;
		Column4.Name = "Column2", ;
		Column4.Sparse = .F., ;
		Column4.Width = 76
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 213,213,255, ;
		Caption = "Fecha Canje", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column1.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column12.cmdver' AS commandbutton WITH ;
		BackColor = 247,247,240, ;
		Caption = "Editar", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 10, ;
		Left = 1, ;
		Name = "cmdver", ;
		Picture = ..\graphics\txt.bmp, ;
		SpecialEffect = 0, ;
		Top = 59, ;
		Width = 10
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column12.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 213,213,255, ;
		Caption = "Usuario", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column12.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column2.Cmdeditar' AS commandbutton WITH ;
		Caption = "Anular", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 27, ;
		Left = 10, ;
		Name = "Cmdeditar", ;
		Top = 25, ;
		Width = 84
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 187,193,247, ;
		Caption = "Editar", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column2.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontStrikethru = .T., ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 213,213,255, ;
		Caption = "Importe", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pgf1.Page3.grimodelos.Column3.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page3.Label1' AS label WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Caption = "Final:", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 16, ;
		Left = 152, ;
		Name = "Label1", ;
		TabIndex = 9, ;
		Top = 18, ;
		Width = 34
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page3.Label6' AS label WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Caption = "Inicio:", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 16, ;
		Left = 28, ;
		Name = "Label6", ;
		TabIndex = 9, ;
		Top = 18, ;
		Width = 34
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pgf1.Page3.Txtfechafinal' AS txtfechafinal WITH ;
		FontName = "Tahoma", ;
		Height = 24, ;
		Left = 151, ;
		Name = "Txtfechafinal", ;
		TabIndex = 4, ;
		Top = 35, ;
		Width = 84
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgf1.Page3.Txtfechainicial' AS txtfechainicial WITH ;
		FontName = "Tahoma", ;
		Height = 24, ;
		Left = 26, ;
		Name = "Txtfechainicial", ;
		TabIndex = 3, ;
		Top = 35, ;
		Width = 83
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />
	
	PROCEDURE Init
		Settear()
		If datosGlobales()=0 Then
			Return .F.
		Endif
		Thisform.pgf1.page1.grimodelos.RecordSource=""
		
	ENDPROC

	PROCEDURE suma
		Select Sum(cant*Prec) As timporte From canjes Into Cursor r
		thisform.pgf1.page1.txttotal1.Value=r.timporte
		
	ENDPROC

	PROCEDURE Pgf1.Page1.Cmdconsulta1.Click
		Local dfechai,dfechaf,nppc,nd,calma
		With Thisform.pgf1.page1
			dfi=.txtfechainicial.Value
			dff=.txtfechafinal.Value
			.grimodelos.RecordSource=""
			.txttotal1.Value=0
			TEXT TO lc noshow
			    Select a.idart as coda,b.Descri,b.unid,a.cant,a.prec,ROUND(cant*a.prec,2) as importe,
				a.idauto,a.idkar,cant as tcant From fe_kar as a INNER Join fe_art as b  On b.idart=a.idart
				inner join fe_rcom as c on c.idauto=a.idauto
				where c.tdoc='20' And c.fech between  ?dfi and ?dff and a.alma>0 and c.idcliente>0 order by b.descri
			ENDTEXT
				IF verificaconexion()=0 then
		RETURN 0
		endif
			ncon=Abreconexion()
			If SQLExec(ncon,lc,'canjes')<0 Then
				errorbd(lc)
				Return
			Endif
			CierraConexion(ncon)
			Select * From canjes Into Cursor canjes Readwrite
			Thisform.suma()
			.grimodelos.RecordSource="canjes"
			.grimodelos.SetFocus
		Endwith
		
	ENDPROC

	PROCEDURE Pgf1.Page1.cmdeliminar.Click
		If verificaAlias("canjes")=1 Then
			Select canjes
			Delete
			Thisform.pgf1.page1.grimodelos.Refresh
			Thisform.suma()
			Thisform.pgf1.page1.grimodelos.SetFocus
		Endif
		
	ENDPROC

	PROCEDURE Pgf1.Page1.grimodelos.Column4.Text1.LostFocus
		If This.Value<=canjes.cant Then
			Replace cant With This.Value,importe With Round(This.Value*Prec,2)  In canjes
			Thisform.suma()
		Else
			Messagebox("EL valor Ingresado debe de ser Igual a la Cantidad Mostrada",16,MSGTITULO)
			Replace cant With canjes.tcant,importe With Round(tcant*Prec,2)  In canjes
		Endif
		
	ENDPROC

	PROCEDURE Pgf1.Page1.grimodelos.Column5.Text1.LostFocus
		Replace Prec With This.Value,importe With Round(cant*This.Value,2)  In canjes
		Thisform.suma()
		
	ENDPROC

	PROCEDURE Pgf1.Page1.grimodelos.Column7.Text1.InteractiveChange
		REPLACE nimporte WITH tcant*this.Value IN pcanje
		thisform.suma()
		
	ENDPROC

	PROCEDURE Pgf1.Page1.grimodelos.Column7.Text1.LostFocus
		REPLACE nimporte WITH tcant*this.Value IN pcanje 
		thisform.suma()
	ENDPROC

	PROCEDURE Pgf1.Page2.Click
		Thisform.pgf1.page2.grimodelos.RecordSource=""
		If verificaAlias("canjes")=0 Then
			Return
		Endif
		With Thisform.pgf1.page2
			Select coda,Descri,unid,Sum(cant) As tcant,;
				Sum(cant*Prec)/Sum(cant) As Prec,;
				Sum(cant*Prec) As importe From canjes Into Cursor pcanje Group By coda
			.grimodelos.RecordSource="pcanje"
			.txtitems.Value=Reccount()
			Select Sum(tcant*Prec) As timporte From pcanje Into Cursor r
		    .txttotal2.Value=r.timporte
		Endwith
		
	ENDPROC

	PROCEDURE Pgf1.Page2.Cmdaceptar1.Click
		Local nrpta
		If Thisform.pgf1.page2.txttotal2.Value=0
			Return
		Endif
		nrpta=Messagebox("¿Canjear Lista [SI/NO/Cancelar]?",32+3+0,MSGTITULO)
		Do Case
		Case nrpta=2
			Thisform.pgf1.page2.grimodelos.SetFocus
			Return
		Case nrpta=6
			Select coda,Descri,unid,tcant As cant,Prec,0 As come,0 As Comc,0 As idco,Recno() As nitem From pcanje Into Cursor tmpp Readwrite
			Do Form ka_fapedidosf With _Tally
			Thisform.pgf1.page1.cmdconsulta1.Click()
			Thisform.pgf1.page2.Click()
		Endcase
		
	ENDPROC

	PROCEDURE Pgf1.Page2.Cmdcerraro1.Click
		USE in(SELECT("fe_kar"))
		USE in(SELECT("fe_rcom"))
		DODEFAULT()
	ENDPROC

	PROCEDURE Pgf1.Page2.grimodelos.Column7.Text1.InteractiveChange
		REPLACE nimporte WITH tcant*this.Value IN pcanje
		thisform.suma()
		
	ENDPROC

	PROCEDURE Pgf1.Page2.grimodelos.Column7.Text1.LostFocus
		REPLACE nimporte WITH tcant*this.Value IN pcanje 
		thisform.suma()
	ENDPROC

	PROCEDURE Pgf1.Page3.Cmdconsulta1.Click
		With Thisform.pgf1.page3
			.grimodelos.RecordSource=""
			dfi=.txtfechainicial.Value
			dff=.txtfechafinal.Value
			TEXT TO lc NOSHOW
		      select a.canj_fech,a.canj_idca from fe_canjesn as a
		      where a.canj_acti='A' and a.canj_fech between ?dfi and ?dff order by canj_fech
			ENDTEXT
				IF verificaconexion()=0 then
		RETURN 0
		endif
			ncon=Abreconexion()
			If SQLExec(ncon,lc,"lcanjes")<1
				errorbd(lc)
				Return
			Endif
			CierraConexion(ncon)
			.grimodelos.RecordSource="lcanjes"
			.grimodelos.SetAll("dynamicbackcolor","iif(MOD(RECNO(),2)=0,RGB(216,216,216),RGB(247,247,240))","Column")
			.grimodelos.column1.SetFocus
		Endwith
		
	ENDPROC

	PROCEDURE Pgf1.Page3.grimodelos.AfterRowColChange
		LPARAMETERS nColIndex
		
	ENDPROC

	PROCEDURE Pgf1.Page3.grimodelos.Column12.cmdver.Click
		Local idcreditos
		idcreditos=dcorrige.idcred
		cndoc=dcorrige.ndoc
		Select ndoc,fech As fepd,fevto,mone As mond,tipo,Impo As impd,acta As actd,banc,idcred As NREG,estd,docd,idven As codv,nomv,idauto From dcorrige;
			WHERE idcred=idcreditos Into Cursor ecta
		Do Form cr_dcorrige
		
	ENDPROC

	PROCEDURE Pgf1.Page3.grimodelos.Column2.Cmdeditar.Click
		Local r As Integer
		r=Messagebox("¿Anular Canje <Si/NO>?",32+4+0,MSGTITULO)
		If r=6 Then
			Set Procedure To capadatos,rngrifo Additive
			If AnulaCanjesNotasVta(lcanjes.canj_idca)=1 Then
				Messagebox("Anulado Correctamente",64,MSGTITULO)
			Endif
		    thisform.pgf1.page3.cmdconsulta1.Click()
		Endif
		
	ENDPROC

	PROCEDURE Pgf1.Page3.Txtfechainicial.GotFocus
		
		
	ENDPROC

ENDDEFINE
