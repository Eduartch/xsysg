*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ar_mmonedas.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS formantenimiento1 AS formantenimiento OF "..\..\librerias\clasesvisuales.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Frame.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.combm" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.Comba" UniqueID="" Timestamp="" />

	BorderStyle = 1
	Caption = "[Detalles]"
	DoCreate = .T.
	Height = 257
	Icon = ..\graphics\anular.ico
	Name = "Formantenimiento1"
	Picture = ..\graphics\appback.jpg
	Width = 403
	Frame.Height = 250
	Frame.Left = 3
	Frame.Name = "Frame"
	Frame.Picture = ..\graphics\appback.jpg
	Frame.Top = 2
	Frame.Width = 393
	cmdcerraro.FontBold = .T.
	cmdcerraro.Left = 100
	cmdcerraro.Name = "cmdcerraro"
	cmdcerraro.Picture = ..\graphics\exit.bmp
	cmdcerraro.Top = 204
	cmdborrar.Left = 228
	cmdborrar.Name = "cmdborrar"
	cmdborrar.Picture = ..\graphics\cancelar1.bmp
	cmdborrar.Top = 36
	cmdborrar.Visible = .F.
	cmdcambiar.Left = 192
	cmdcambiar.Name = "cmdcambiar"
	cmdcambiar.Picture = ..\..\psysl\graphics\sync.bmp
	cmdcambiar.Top = 96
	cmdcambiar.Visible = .F.
	Chkeditar1.Alignment = 0
	Chkeditar1.Name = "Chkeditar1"
	cmdaceptar.FontBold = .T.
	cmdaceptar.Left = 11
	cmdaceptar.Name = "cmdaceptar"
	cmdaceptar.Picture = ..\graphics\38.bmp
	cmdaceptar.Top = 204
	Themedtitlebar1.CMDCLOSE.LBLSYMBOL.Name = "LBLSYMBOL"
	Themedtitlebar1.CMDCLOSE.Name = "CMDCLOSE"
	Themedtitlebar1.CMDMAXIMIZE.LBLSYMBOL.Name = "LBLSYMBOL"
	Themedtitlebar1.CMDMAXIMIZE.Name = "CMDMAXIMIZE"
	Themedtitlebar1.CMDMINIMIZE.LBLSYMBOL.Name = "LBLSYMBOL"
	Themedtitlebar1.CMDMINIMIZE.Name = "CMDMINIMIZE"
	Themedtitlebar1.EDTDESCRIPTION.Name = "EDTDESCRIPTION"
	Themedtitlebar1.IMGTITLE.Name = "IMGTITLE"
	Themedtitlebar1.LBLCAPTION.Name = "LBLCAPTION"
	Themedtitlebar1.Name = "Themedtitlebar1"

	ADD OBJECT 'Frame.Comba' AS cmbaño WITH ;
		Height = 24, ;
		Left = 17, ;
		Name = "Comba", ;
		TabIndex = 4, ;
		Top = 79, ;
		Width = 124
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="combobox" />

	ADD OBJECT 'Frame.combm' AS combobox WITH ;
		BorderColor = 192,192,192, ;
		ColumnCount = 0, ;
		ColumnWidths = "", ;
		ControlSource = "", ;
		FirstElement = 1, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 26, ;
		Left = 15, ;
		Name = "combm", ;
		NumberOfElements = 0, ;
		RowSource = "", ;
		RowSourceType = 1, ;
		SpecialEffect = 1, ;
		StatusBarText = "Seleccione el Mes a Ingresar", ;
		Style = 2, ;
		TabIndex = 3, ;
		Top = 22, ;
		Width = 130
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Frame.Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Año:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 15, ;
		Name = "Label1", ;
		TabIndex = 1, ;
		Top = 65, ;
		Width = 29
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Frame.Label2' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Mes:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 15, ;
		Name = "Label2", ;
		TabIndex = 2, ;
		Top = 5, ;
		Width = 30
		*< END OBJECT: BaseClass="label" />
	
	PROCEDURE Init
		LPARAMETERS cmodo,nreg
		thisform.modo=cmodo
		THISFORM.frame.combm.RowSource="Enero,Febrero,Marzo,Abril,Mayo,Junio,Julio,Agosto,Setiembre,Octubre,Noviembre,Diciembre"
		WITH thisform.frame 
		.comba.value=STR(YEAR(DATE()))
		.combm.listindex=MONTH(DATE())
		.combm.setfocus
		ENDWITH 
	ENDPROC

	PROCEDURE cmdaceptar.Click
		Local r
		r=Messagebox("¿Adicionar a Este Los Registros para el Tipo de Cambio[Si/No]?",32+3+0,MSGTITULO)
		Do Case
		Case r=2
			Thisform.frame.comba.SetFocus
			Return
		Case r=6
			nm=Thisform.frame.combm.ListIndex
			na=Val(Thisform.frame.comba.Value)
			TEXT TO lc NOSHOW
		             SELECT fech FROM fe_mon WHERE MONTH(feCh)=?nm anD YEAR(fech)=?na
			ENDTEXT
			IF verificaconexion()=0 then
		RETURN 0
		endif
			If SQLExec(goapp.bdconn,lc,"Ya")<0
				errorbd(lc)
				Return
			Endif
			If REgdvto("ya")>0 Then
				Messagebox("Fecha Ya Registrada......",16,MSGTITULO)
				Return
			Endif
			If RegistraTipoCambioSunat(nm,na)=0 Then
				Return
			Endif
			Thisform.cmdcerraro.Click()
		Endcase
		
	ENDPROC

	PROCEDURE cmdborrar.Click
		Return 
	ENDPROC

	PROCEDURE cmdcambiar.Click
		**
	ENDPROC

ENDDEFINE
