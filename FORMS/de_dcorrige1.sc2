*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="de_dcorrige1.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 200
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 520

ENDDEFINE

DEFINE CLASS forcpagar AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cmdcerraro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdaceptar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtreferencia" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lbldocumento" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdocumento" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtfecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtimporte" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmbmoneda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdolar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtfechavto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdetalle" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmbtipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtnrounico" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: ejecutar
		*m: grabar
		*p: cvendedor
		*p: tipo
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 1
	Caption = "Actualizar [Cuentas Por Pagar]"
	ControlBox = .T.
	DoCreate = .T.
	Height = 383
	Icon = ..\graphics\anular.ico
	MaxButton = .F.
	MinButton = .F.
	Name = "forcpagar"
	Picture = ..\graphics\appback.jpg
	ShowWindow = 1
	Width = 444
	WindowState = 0
	WindowType = 1

	ADD OBJECT 'Cmbmoneda' AS cmbmoneda WITH ;
		Enabled = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 120, ;
		Margin = 2, ;
		Name = "Cmbmoneda", ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 4, ;
		Top = 91, ;
		Width = 122
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="combobox" />

	ADD OBJECT 'cmbtipo' AS combobox WITH ;
		Enabled = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 27, ;
		Left = 120, ;
		Margin = 2, ;
		Name = "cmbtipo", ;
		ReadOnly = .F., ;
		RowSource = "Letra,Factura,Boleta", ;
		RowSourceType = 1, ;
		SpecialEffect = 1, ;
		Style = 2, ;
		TabIndex = 9, ;
		Top = 208, ;
		Width = 120
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Cmdaceptar' AS cmdaceptar WITH ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 35, ;
		Left = 37, ;
		Name = "Cmdaceptar", ;
		PicturePosition = 0, ;
		TabIndex = 15, ;
		Top = 336, ;
		Width = 85
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcerraro' AS cmdcerraro WITH ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 35, ;
		Left = 337, ;
		Name = "Cmdcerraro", ;
		PicturePosition = 0, ;
		TabIndex = 16, ;
		Top = 336, ;
		Width = 85
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Fecha Vto:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 15, ;
		Left = 5, ;
		Name = "Label1", ;
		TabIndex = 22, ;
		Top = 65, ;
		Width = 67
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label10' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Nro Unico:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 17, ;
		Left = 5, ;
		Name = "Label10", ;
		TabIndex = 20, ;
		Top = 181, ;
		Width = 74
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Banco:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 15, ;
		Left = 5, ;
		Name = "Label2", ;
		TabIndex = 18, ;
		Top = 268, ;
		Width = 59
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Moneda:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 15, ;
		Left = 5, ;
		Name = "Label3", ;
		TabIndex = 13, ;
		Top = 93, ;
		Width = 53
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Dcto.Referencia:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 16, ;
		Left = 5, ;
		Name = "Label4", ;
		TabIndex = 17, ;
		Top = 10, ;
		Width = 98
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Dólar:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 15, ;
		Left = 5, ;
		Name = "Label5", ;
		TabIndex = 24, ;
		Top = 126, ;
		Width = 37
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Importe:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 18, ;
		Left = 5, ;
		Name = "Label6", ;
		TabIndex = 21, ;
		Top = 242, ;
		Width = 57
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Tipo:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 15, ;
		Left = 5, ;
		Name = "Label7", ;
		TabIndex = 14, ;
		Top = 218, ;
		Width = 35
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label8' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Fecha:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 15, ;
		Left = 5, ;
		Name = "Label8", ;
		TabIndex = 23, ;
		Top = 36, ;
		Width = 44
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lbldocumento' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Nº de Documento:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		Height = 17, ;
		Left = 5, ;
		Name = "lbldocumento", ;
		TabIndex = 19, ;
		Top = 155, ;
		Width = 101
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'txtdetalle' AS textbox WITH ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 25, ;
		Left = 120, ;
		Margin = 2, ;
		MaxLength = 25, ;
		Name = "txtdetalle", ;
		ReadOnly = .F., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 11, ;
		Top = 266, ;
		Width = 300
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtdocumento' AS textbox WITH ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 25, ;
		Left = 120, ;
		Margin = 2, ;
		MaxLength = 10, ;
		Name = "txtdocumento", ;
		ReadOnly = .T., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 7, ;
		Top = 152, ;
		Width = 120
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtdolar' AS textbox WITH ;
		Alignment = 3, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "9.999", ;
		Height = 25, ;
		InputMask = "9.999", ;
		Left = 120, ;
		Margin = 2, ;
		Name = "txtdolar", ;
		ReadOnly = .T., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 6, ;
		Top = 122, ;
		Value = 0, ;
		Width = 120
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtfecha' AS textbox WITH ;
		Alignment = 3, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 25, ;
		Left = 120, ;
		Margin = 2, ;
		Name = "txtfecha", ;
		ReadOnly = .T., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 2, ;
		Top = 34, ;
		Value = (date()), ;
		Width = 120
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtfechavto' AS textbox WITH ;
		Alignment = 3, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 25, ;
		Left = 120, ;
		Margin = 2, ;
		Name = "txtfechavto", ;
		ReadOnly = .F., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 3, ;
		Top = 63, ;
		Value = , ;
		Width = 120
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtimporte' AS textbox WITH ;
		Alignment = 3, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "999,999.999", ;
		Height = 24, ;
		InputMask = "999,999.99", ;
		Left = 120, ;
		Margin = 2, ;
		Name = "txtimporte", ;
		ReadOnly = .T., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 10, ;
		Top = 238, ;
		Value = 0, ;
		Width = 120
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtnrounico' AS textbox WITH ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 25, ;
		Left = 120, ;
		Margin = 2, ;
		MaxLength = 20, ;
		Name = "txtnrounico", ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 8, ;
		Top = 181, ;
		Width = 300
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtreferencia' AS textbox WITH ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 25, ;
		Left = 120, ;
		Margin = 2, ;
		MaxLength = 10, ;
		Name = "txtreferencia", ;
		ReadOnly = .T., ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 1, ;
		Top = 7, ;
		Width = 120
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE ejecutar
		Lparameters ctipo
		rpta=Messagebox("¿Guardar los Datos [S/N]?",48+3+0,MSGTITULO)
		Do Case
		Case rpta=2
			Thisform.txtdocumento.SetFocus
			Return
		Case rpta=6
			ncodi=ecta.ncontrol
			cnrou=Thisform.txtnrounico.Value
			cbanc=Thisform.txtdetalle.Value
			dfechav=Thisform.txtfechavto.Value
			TEXT TO lc NOSHOW
		             UPDATE fe_deu SET nrou=?cnrou,banc=?cbanc,fevto=?dfechav WHERE ncontrol=?ncodi
			ENDTEXT
				IF verificaconexion()=0 then
		RETURN 0
		endif
			If SQLExec(goapp.bdconn,lc)<1
				errorbd(lc)
				Return
			Endif
		Case rpta=7
			Thisform.cmdcerraro.Click()
		Endcase
		
	ENDPROC

	PROCEDURE grabar
	ENDPROC

	PROCEDURE Init
		With Thisform
			.txtreferencia.Value=ecta.docd
			.txtdocumento.Value=ecta.ndoc
			.txtfecha.Value=ecta.fech
			.txtfechavto.Value=ecta.fevto
			.txtnrounico.Value=ecta.nrou
			.cmbmoneda.ListIndex=Iif(ecta.mone="S",1,2)
			Do Case
			Case ecta.tipo="L"
				.cmbtipo.ListIndex=1
			Case ecta.tipo="F"
				.cmbtipo.ListIndex=2
			Case ecta.tipo="N"
				.cmbtipo.ListIndex=3
			Case ecta.tipo="P"
				.cmbtipo.ListIndex=4
			Endcase
			.txtdetalle.Value=ecta.banc
			.tipo="C"
			.txtimporte.Value=Iif(ecta.impo>0,ecta.impo,ABS(ecta.impo))
		Endwith
		
	ENDPROC

	PROCEDURE Cmdaceptar.Click
		thisform.ejecutar("M")
		thisform.cmdcerraro.Click()
	ENDPROC

	PROCEDURE txtimporte.GotFocus
		if empty(thisform.txtdocumento.value)
		   thisform.txtdocumento.setfocus
		   RETURN 
		ENDIF    
	ENDPROC

ENDDEFINE
