*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ka_rbaja.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 451
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 792

ENDDEFINE

DEFINE CLASS fordetallescompras AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cmdcerraro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column9.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Cmd1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdaexcel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdejecutar1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Comprobante1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdejecutar2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtticket" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdconsulta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtfecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdborrar1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdborrar2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtitem" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcal2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblet1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="titulo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Titulo2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Titulo3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Titulo4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Titulo5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Titulo6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Timer1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: csql
		*p: nalmacen
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 1
	Caption = "[Comunicación de Baja]"
	Closable = .T.
	ControlBox = .T.
	csql = 
	DataSession = 2
	DoCreate = .T.
	Height = 566
	Icon = ..\graphics\search.ico
	MaxButton = .F.
	MinButton = .T.
	Movable = .T.
	nalmacen = 0
	Name = "fordetallescompras"
	Picture = ..\graphics\fondoazul.jpg
	ShowWindow = 1
	TitleBar = 0
	Width = 999
	WindowState = 0
	WindowType = 0

	ADD OBJECT 'Cmdaexcel1' AS cmdaexcel WITH ;
		BackColor = 255,255,128, ;
		calias = rmvtos, ;
		cgriddata = thisform.grimodelos, ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 35, ;
		Left = 821, ;
		Name = "Cmdaexcel1", ;
		PicturePosition = 1, ;
		TabIndex = 19, ;
		Top = 525, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\salidas.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdborrar1' AS cmdborrar WITH ;
		BackColor = 224,224,224, ;
		Caption = "Quitar Documento", ;
		FontBold = .F., ;
		FontSize = 8, ;
		Height = 38, ;
		Left = 102, ;
		Name = "Cmdborrar1", ;
		Picture = ..\..\, ;
		PicturePosition = 1, ;
		Top = 99, ;
		Width = 85, ;
		WordWrap = .T.
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdborrar2' AS cmdborrar WITH ;
		BackColor = 224,224,224, ;
		Caption = "Quitar Lista", ;
		FontBold = .F., ;
		FontSize = 8, ;
		Height = 38, ;
		Left = 184, ;
		Name = "Cmdborrar2", ;
		Picture = ..\..\, ;
		PicturePosition = 1, ;
		Top = 99, ;
		Width = 85
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcal2' AS cmdcal WITH ;
		Height = 34, ;
		Left = 144, ;
		Name = "Cmdcal2", ;
		Top = 63, ;
		Width = 32
		*< END OBJECT: ClassLib="..\libs\lmcal.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcerraro' AS cmdcerraro WITH ;
		BackColor = 255,255,128, ;
		Caption = "\<Retornar", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 35, ;
		Left = 900, ;
		Name = "Cmdcerraro", ;
		PicturePosition = 1, ;
		TabIndex = 16, ;
		Top = 525, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdconsulta' AS commandbutton WITH ;
		BackColor = 224,224,224, ;
		Caption = "Otro Documento", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 38, ;
		Left = 20, ;
		Name = "cmdconsulta", ;
		Picture = ..\..\, ;
		PicturePosition = 1, ;
		TabIndex = 15, ;
		Top = 99, ;
		Width = 85, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Cmdejecutar1' AS cmdejecutar WITH ;
		Caption = "Enviar", ;
		FontBold = .T., ;
		Height = 30, ;
		Left = 7, ;
		Name = "Cmdejecutar1", ;
		Picture = ..\..\, ;
		PicturePosition = 1, ;
		TabIndex = 20, ;
		Top = 529, ;
		Width = 93
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdejecutar2' AS cmdejecutar WITH ;
		Caption = "Consultar  CDR", ;
		FontBold = .T., ;
		Height = 41, ;
		Left = 298, ;
		Name = "Cmdejecutar2", ;
		Picture = ..\graphics\consultar.jpg, ;
		PicturePosition = 1, ;
		Top = 520, ;
		Visible = .F., ;
		Width = 100
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Comprobante1' AS comprobante WITH ;
		Left = 324, ;
		Name = "Comprobante1", ;
		Top = 528
		*< END OBJECT: ClassLib="..\..\librerias\fe.vcx" BaseClass="custom" />

	ADD OBJECT 'grimodelos' AS grid WITH ;
		BackColor = 234,234,234, ;
		ColumnCount = 12, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		HeaderHeight = 29, ;
		Height = 158, ;
		HighlightBackColor = 187,221,255, ;
		HighlightForeColor = 0,0,0, ;
		HighlightStyle = 1, ;
		Left = 6, ;
		Name = "grimodelos", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RowHeight = 25, ;
		ScrollBars = 0, ;
		TabIndex = 17, ;
		Themes = .F., ;
		Top = 170, ;
		Visible = .T., ;
		Width = 981, ;
		Column1.BackColor = 234,234,234, ;
		Column1.ColumnOrder = 3, ;
		Column1.FontName = "Tahoma", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Visible = .T., ;
		Column1.Width = 80, ;
		Column2.BackColor = 234,234,234, ;
		Column2.ColumnOrder = 4, ;
		Column2.FontName = "Tahoma", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 72, ;
		Column3.BackColor = 234,234,234, ;
		Column3.ColumnOrder = 5, ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 8, ;
		Column3.Format = "", ;
		Column3.InputMask = "", ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .T., ;
		Column3.Width = 229, ;
		Column4.BackColor = 234,234,234, ;
		Column4.ColumnOrder = 6, ;
		Column4.FontName = "Tahoma", ;
		Column4.FontSize = 8, ;
		Column4.Format = "", ;
		Column4.InputMask = "", ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Visible = .T., ;
		Column4.Width = 67, ;
		Column5.BackColor = 234,234,234, ;
		Column5.ColumnOrder = 7, ;
		Column5.FontName = "Tahoma", ;
		Column5.FontSize = 8, ;
		Column5.Format = "", ;
		Column5.InputMask = "", ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Visible = .T., ;
		Column5.Width = 59, ;
		Column6.BackColor = 234,234,234, ;
		Column6.ColumnOrder = 8, ;
		Column6.FontName = "Tahoma", ;
		Column6.FontSize = 8, ;
		Column6.Format = "999,999.99", ;
		Column6.InputMask = "999,999.99", ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Visible = .T., ;
		Column6.Width = 63, ;
		Column7.BackColor = 234,234,234, ;
		Column7.ColumnOrder = 9, ;
		Column7.FontName = "Tahoma", ;
		Column7.FontSize = 8, ;
		Column7.Format = "999,999.99", ;
		Column7.InputMask = "999,999.99", ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T., ;
		Column7.Visible = .T., ;
		Column7.Width = 67, ;
		Column8.BackColor = 234,234,234, ;
		Column8.ColumnOrder = 10, ;
		Column8.FontName = "Tahoma", ;
		Column8.FontSize = 8, ;
		Column8.Format = "999,999.99", ;
		Column8.InputMask = "999,999.99", ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Visible = .T., ;
		Column8.Width = 73, ;
		Column9.Alignment = 2, ;
		Column9.BackColor = 234,234,234, ;
		Column9.ColumnOrder = 11, ;
		Column9.FontName = "Tahoma", ;
		Column9.FontSize = 8, ;
		Column9.Name = "Column9", ;
		Column9.ReadOnly = .T., ;
		Column9.Visible = .T., ;
		Column9.Width = 59, ;
		Column10.BackColor = 234,234,234, ;
		Column10.ColumnOrder = 12, ;
		Column10.CurrentControl = "Text1", ;
		Column10.FontName = "Tahoma", ;
		Column10.FontSize = 8, ;
		Column10.Name = "Column10", ;
		Column10.ReadOnly = .T., ;
		Column10.Sparse = .F., ;
		Column10.Visible = .T., ;
		Column10.Width = 109, ;
		Column11.BackColor = 234,234,234, ;
		Column11.ColumnOrder = 1, ;
		Column11.FontName = "Tahoma", ;
		Column11.FontSize = 8, ;
		Column11.Name = "Column11", ;
		Column11.ReadOnly = .T., ;
		Column11.Visible = .T., ;
		Column11.Width = 37, ;
		Column12.BackColor = 234,234,234, ;
		Column12.ColumnOrder = 2, ;
		Column12.FontName = "Tahoma", ;
		Column12.FontSize = 8, ;
		Column12.Name = "Column12", ;
		Column12.ReadOnly = .T., ;
		Column12.Visible = .T., ;
		Column12.Width = 49
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'grimodelos.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "N° Documento", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column1.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column10.Cmd1' AS cmd WITH ;
		Left = 12, ;
		Name = "Cmd1", ;
		Top = 34
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'grimodelos.Column10.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Respuesta", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column10.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column11.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "T.Dcto", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column11.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column12.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Serie", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column12.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Fecha", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column2.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Razón Social", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column3.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Subtotal", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column4.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Exonerado", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column5.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Inafecto", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column6.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "IGV", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column7.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column8.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Importe", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column8.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column9.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Código HASH", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column9.Text1' AS textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Label3' AS label WITH ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		Caption = "Fecha Emisión Baja:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 12, ;
		Left = 20, ;
		Name = "Label3", ;
		TabIndex = 2, ;
		Top = 55, ;
		Width = 124
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Ticket:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 108, ;
		Name = "Label4", ;
		TabIndex = 18, ;
		Top = 539, ;
		Width = 39
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Items:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 9, ;
		Name = "Label6", ;
		TabIndex = 53, ;
		Top = 501, ;
		Width = 36
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Lblet1' AS lblet WITH ;
		BackColor = 213,234,255, ;
		BorderColor = 230,230,230, ;
		Height = 99, ;
		Left = 309, ;
		Name = "Lblet1", ;
		Top = 42, ;
		Width = 678
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="shape" />

	ADD OBJECT 'Shape11' AS shape1 WITH ;
		BackStyle = 0, ;
		BorderColor = 128,128,128, ;
		Height = 93, ;
		Left = 7, ;
		Name = "Shape11", ;
		Top = 49, ;
		Width = 281
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="shape" />

	ADD OBJECT 'Timer1' AS timer WITH ;
		Height = 23, ;
		Interval = 500, ;
		Left = 372, ;
		Name = "Timer1", ;
		Top = 492, ;
		Width = 23
		*< END OBJECT: BaseClass="timer" />

	ADD OBJECT 'titulo1' AS titulo WITH ;
		Caption = "- Seleccione el Documento para dar de baja haciendo CLICK en el Botón OTRO DOCUMENTO", ;
		FontSize = 10, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 313, ;
		Name = "titulo1", ;
		Top = 50, ;
		Width = 564
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="label" />

	ADD OBJECT 'Titulo2' AS titulo WITH ;
		Caption = "- Si es Conforme el Documento Hacer Click en Enviar ", ;
		FontSize = 10, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 313, ;
		Name = "Titulo2", ;
		Top = 85, ;
		Width = 564
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="label" />

	ADD OBJECT 'Titulo3' AS titulo WITH ;
		Caption = "- Al envíar el sistema genera un Número(Ticket) que sera consultado al hacer Click en CONSULTAR TICKET", ;
		FontSize = 10, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 313, ;
		Name = "Titulo3", ;
		Top = 102, ;
		Width = 660
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="label" />

	ADD OBJECT 'Titulo4' AS titulo WITH ;
		Caption = "- Si la Respuesta que el sistema obtiene es satisfactoria el proceso de baja ha concluido", ;
		FontSize = 10, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 312, ;
		Name = "Titulo4", ;
		Top = 119, ;
		Width = 660
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="label" />

	ADD OBJECT 'Titulo5' AS titulo WITH ;
		Caption = "- Utilize los botone QUITAR DOCUMENTO o QUITAR LISTA si los documentos seleccionados no son los correctos", ;
		FontSize = 10, ;
		ForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 313, ;
		Name = "Titulo5", ;
		Top = 68, ;
		Width = 672
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="label" />

	ADD OBJECT 'Titulo6' AS titulo WITH ;
		Left = -3, ;
		Name = "Titulo6", ;
		Top = -1, ;
		Shape1.Name = "Shape1", ;
		Lbl1.Caption = "[Comunicación de Baja]", ;
		Lbl1.Name = "Lbl1", ;
		Image1.Name = "Image1", ;
		Image3.Name = "Image3", ;
		Image2.Name = "Image2"
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="container" />

	ADD OBJECT 'Txtfecha' AS txtfechainicial WITH ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 22, ;
		Name = "Txtfecha", ;
		SpecialEffect = 1, ;
		TabIndex = 12, ;
		Top = 72, ;
		Width = 110
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtitem' AS textbox WITH ;
		Alignment = 3, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "99", ;
		Height = 23, ;
		InputMask = "99", ;
		Left = 51, ;
		Name = "txtitem", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 50, ;
		Top = 498, ;
		Value = 0, ;
		Visible = .T., ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtticket' AS textbox WITH ;
		BorderColor = 224,224,224, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 161, ;
		MaxLength = 30, ;
		Name = "txtticket", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 9, ;
		Top = 534, ;
		Width = 132
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Init
		Settear()
		If datosGlobales()=0 Then
			Return .F.
		Endif
		Thisform.GRimodelos.RecordSource=""
		Create Cursor rmvtos(tdoc c(2),serie c(4),ndoc c(8),fech d,razo c(100),valor N(12,2),rcom_exon N(12,2),inafecto N(12,2),;
			igv N(12,2),Impo N(12,2),rcom_hash c(30),rcom_mens c(70),idauto N,idusuav N(5))
		Thisform.GRimodelos.RecordSource="rmvtos"
		Thisform.GRimodelos.column11.ControlSource="rmvtos.tdoc"
		Thisform.GRimodelos.column1.ControlSource="rmvtos.ndoc"
		Thisform.GRimodelos.column2.ControlSource="rmvtos.fech"
		Thisform.GRimodelos.column3.ControlSource="rmvtos.razo"
		Thisform.GRimodelos.column4.ControlSource="rmvtos.valor"
		Thisform.GRimodelos.column5.ControlSource="rmvtos.rcom_exon"
		Thisform.GRimodelos.column6.ControlSource="rmvtos.inafecto"
		Thisform.GRimodelos.column7.ControlSource="rmvtos.igv"
		Thisform.GRimodelos.column8.ControlSource="rmvtos.impo"
		Thisform.GRimodelos.column9.ControlSource="rmvtos.rcom_hash"
		Thisform.GRimodelos.column10.ControlSource="rmvtos.rcom_mens"
		
	ENDPROC

	PROCEDURE Unload
		*CierraCursor("rmvtos")
	ENDPROC

	PROCEDURE Cmdaexcel1.Click
		If verificaAlias("rmvtos")=1 Then
			This.titulo1="Reporte de Transacciones"
			If Thisform.chkagrupa.Value=1 Then
				This.calias="res"
				This.cgriddata="thisform.grimodelos1"
			Else
				This.calias="rmvtos"
				This.cgriddata="thisform.grimodelos"
			Endif
			DoDefault()
		Endif
		
	ENDPROC

	PROCEDURE Cmdborrar1.Click
		If Thisform.txtitem.Value=0 Then
			Return
		Endif
		Select rmvtos
		Delete
		Thisform.txtitem.Value=Thisform.txtitem.Value-1
		Thisform.grimodelos.Refresh
		Thisform.grimodelos.SetFocus
		
	ENDPROC

	PROCEDURE Cmdborrar2.Click
		Select rmvtos
		Zap
		Thisform.txtitem.Value=0
		Thisform.grimodelos.Refresh
		Thisform.grimodelos.SetFocus
		
	ENDPROC

	PROCEDURE cmdconsulta.Click
		Do Form ka_lselecciona With 0,'V' To vdvto
		If  vdvto>0  AND ldctos.tdoc<>'03' 
		*AND (fe_gene.fech-ldctos.fech)<=7 Then
			Select rmvtos
			Locate For idauto=vdvto
			If !Found()
				Insert Into rmvtos(tdoc,serie,ndoc,fech,razo,valor,rcom_exon,inafecto,igv,Impo,rcom_hash,rcom_mens,idauto,idusuav);
					Values(ldctos.tdoc,Iif(Len(Alltrim(ldctos.ndoc))=10,Left(ldctos.ndoc,3),Left(ldctos.ndoc,4)),;
					Iif(Len(Alltrim(ldctos.ndoc))=10,Substr(ldctos.ndoc,4),Substr(ldctos.ndoc,5)),;
					ldctos.fech,ldctos.razo,ldctos.valor,0,0,ldctos.igv,ldctos.Impo,;
					ldctos.rcom_hash,ldctos.rcom_mens,vdvto,ldctos.idusuav)
				Thisform.txtitem.Value=Thisform.txtitem.Value+1
				Thisform.grimodelos.Refresh
				Thisform.grimodelos.SetFocus
			Else
				Messagebox("Este Documento ya esta Seleccionado",16,MSGTITULO)
			Endif
		Endif
		Return
		*If vdvto>0  AND ldctos.tdoc<>'03' AND (fe_gene.fech-ldctos.fech)<=7 Then
	ENDPROC

	PROCEDURE Cmdejecutar1.Click
		If Thisform.txtitem.Value=0 Then
			Return
		Endif
		If Messagebox("¿Enviar Lista de Documento Para dar Baja <Si/No>?",32+4+0,MSGTITULO)<>6 Then
			Return
		Endif
		If datosGlobales()=0 Then
			Return
		Endif
		df=Thisform.txtfecha.Value
		Set Procedure To Capadatos Additive
		Select idauto,fech,idusuav,tdoc From rmvtos  Into Cursor acur Group By idauto
		Select acur
		sw=1
		Scan All
			If PermiteAnularVenta(acur.idauto,acur.fech)=0 Then
				Messagebox("No Se Válido Correctamente Documento: "+acur.ndoc,16,MSGTITULO)
				sw=0
				Exit
			Endif
		Endscan
		If sw=0 Then
			Return
		Endif
		Go Top In rmvtos
		dfd=rmvtos.fech
		cnombreArchivo=Alltrim(Str(Year(df)))+Iif(Month(df)<=9,'0'+Alltrim(Str(Month(df))),Alltrim(Str(Month(df))))+Iif(Day(df)<=9,'0'+Alltrim(Str(Day(df))),Alltrim(Str(Day(df))))
		Thisform.comprobante1.fechaemision=Alltrim(Str(Year(df)))+'-'+Iif(Month(df)<=9,'0'+Alltrim(Str(Month(df))),Alltrim(Str(Month(df))))+'-'+Iif(Day(df)<=9,'0'+Alltrim(Str(Day(df))),Alltrim(Str(Day(df))))
		Thisform.comprobante1.fechadocumentos=Alltrim(Str(Year(dfd)))+'-'+Iif(Month(dfd)<=9,'0'+Alltrim(Str(Month(dfd))),Alltrim(Str(Month(dfd))))+'-'+Iif(Day(dfd)<=9,'0'+Alltrim(Str(Day(dfd))),Alltrim(Str(Day(dfd))))
		Thisform.comprobante1.rucfirma=fe_gene.rucfirmad
		Thisform.comprobante1.nombrefirmadigital=fe_gene.razonfirmad
		Thisform.comprobante1.rucemisor=fe_gene.nruc
		Thisform.comprobante1.razonsocialempresa=fe_gene.empresa
		Thisform.comprobante1.ubigeo=fe_gene.ubigeo
		Thisform.comprobante1.direccionempresa=fe_gene.ptop
		Thisform.comprobante1.ciudademisor=fe_gene.ciudad
		Thisform.comprobante1.distritoemisor=fe_gene.distrito
		Thisform.comprobante1.pais='PE'
		i=0
		Select tdoc,serie,ndoc As numero,"Error en el Proceso de Generación" As motivo,idauto,df As fech;
			FROM rmvtos  Into Cursor curb Group By idauto
		Select curb
		Thisform.comprobante1.itemsdocumentos=Reccount()
		tr=Thisform.comprobante1.itemsdocumentos
		cserie=cnombreArchivo+"-"+Alltrim(Str(fe_gene.gene_nbaj))
		Dimension Thisform.comprobante1.itemsdocumentos[tr,15]
		Dimension listadctos(tr) As Integer
		swb=1
		Select curb
		Scan All
			i=i+1
			Thisform.comprobante1.itemsdocumentos[i,1]=curb.tdoc
			Thisform.comprobante1.itemsdocumentos[i,2]=Alltrim(curb.serie)
			Thisform.comprobante1.itemsdocumentos[i,3]=Alltrim(curb.numero)
			Thisform.comprobante1.itemsdocumentos[i,4]=Alltrim(curb.motivo)
		Endscan
		Try
			If Thisform.comprobante1.generarxmlcomunicaciondebaja(fe_gene.nruc,cserie)=1 Then
				If generaCorrelativoEnvioResumenBajas()=1 Then
					Mensaje("Se Grabo el Correlativo de Envio de Bajas Correctamente")
				Endif
				Mensaje("Proceso de Envio se realizo Correctamente")
			Endif
			Thisform.txtticket.Value=goapp.ticket
			This.Parent.timer1.Enabled= .T.
		Catch To oerr When oerr.ErrorNo=1429
			Messagebox(MENSAJE1+MENSAJE2+MENSAJE3,16,MSGTITULO)
		Catch To oerr When oerr.ErrorNo=1924
			Messagebox(MENSAJE1+MENSAJE2+MENSAJE3,16,MSGTITULO)
		Finally
		Endtry
	ENDPROC

	PROCEDURE Cmdejecutar2.Click
		If Empty(Thisform.txtticket.Value) Then
			Return
		Endif
		Set Procedure To capadatos,ple5 Additive
		Try
			Do While .T.
				rpta=ConsultaTicket(Alltrim(Thisform.txtticket.Value),goapp.carchivo)
				If rpta>=0 Then
					Exit
				Endif
			Enddo
			If rpta=0 Then
				If verificaAlias("curb")=1 Then
					If curb.idauto>0 Then
						Select curb
						Scan All
							dfecha=fe_gene.fech
							If AnulaTransaccion('','','V',curb.idauto,goapp.nidusua,'S',dfecha,goapp.uauto)=0 Then
								Messagebox("No Se Anulo Correctamente de la Base de Datos",16,MSGTITULO)
								Exit
							Endif
						Endscan
						Messagebox("Proceso de Anulación Culminado Correctamente",48,MSGTITULO)
					Endif
				Endif
				Thisform.cmdborrar2.Click()
			Endif
		Catch To oerr When oerr.ErrorNo=1429
			Messagebox(MENSAJE1+MENSAJE2+MENSAJE3,16,MSGTITULO)
		Catch To oerr When oerr.ErrorNo=1924
			Messagebox(MENSAJE1+MENSAJE2+MENSAJE3,16,MSGTITULO)
		Finally
		Endtry
		
	ENDPROC

	PROCEDURE grimodelos.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE Timer1.Timer
		This.Enabled= .F.
		If !Empty(This.Parent.txtticket.Value) Then
			This.Parent.cmdejecutar2.Click()
		Endif
		
	ENDPROC

ENDDEFINE
