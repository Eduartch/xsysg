*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ka_rxf.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 451
	Left = -228
	Name = "Dataenvironment"
	Top = 233
	Width = 792

ENDDEFINE

DEFINE CLASS fordetallescompras AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Container1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkdcto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdconsulta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmbmoneda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtfechainicial" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtfechafinal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcerraro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmbdcto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtserie" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column9.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Cmdconsulta1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column10.Link1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Cmd1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Cmdconsulta1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column11.Link1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column2.Ckpreciosa1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grimodelos.Column12.Link1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmbtienda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Chktienda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdaexcel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkmoneda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtlocalizador1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Optbusqueda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="titulo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcal1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcal2" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: csql
		*p: nalmacen
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 1
	Caption = "[Reporte de Documentos de Ventas Emitidos]"
	Closable = .T.
	ControlBox = .T.
	csql = 
	DataSession = 2
	DoCreate = .T.
	Height = 566
	Icon = ..\graphics\anular.ico
	MaxButton = .F.
	MinButton = .T.
	Movable = .T.
	nalmacen = 0
	Name = "fordetallescompras"
	Picture = ..\graphics\fondoazul.jpg
	ShowWindow = 1
	TitleBar = 0
	Width = 1061
	WindowState = 0
	WindowType = 0

	ADD OBJECT 'chkdcto' AS checkbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		Caption = "Tipo Dcto:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 18, ;
		Name = "chkdcto", ;
		SpecialEffect = 1, ;
		TabIndex = 5, ;
		Top = 56, ;
		Width = 75
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'chkmoneda' AS checkbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		Caption = "Moneda:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 18, ;
		Name = "chkmoneda", ;
		SpecialEffect = 1, ;
		TabIndex = 7, ;
		Top = 84, ;
		Width = 68
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'Chktienda' AS chktienda WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Left = 408, ;
		Name = "Chktienda", ;
		TabIndex = 10, ;
		Top = 51
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="checkbox" />

	ADD OBJECT 'cmbdcto' AS combobox WITH ;
		BorderColor = 224,224,224, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 120, ;
		Name = "cmbdcto", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		SpecialEffect = 1, ;
		Style = 2, ;
		TabIndex = 6, ;
		Top = 51, ;
		Width = 130
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Cmbmoneda' AS cmbmoneda WITH ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 22, ;
		Left = 120, ;
		Name = "Cmbmoneda", ;
		RowSource = "Soles,Dólares", ;
		SpecialEffect = 1, ;
		TabIndex = 8, ;
		Top = 77, ;
		Width = 130
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cmbtienda' AS cmbtienda WITH ;
		BorderColor = 224,224,224, ;
		Enabled = .T., ;
		Left = 408, ;
		Name = "Cmbtienda", ;
		TabIndex = 11, ;
		Top = 67
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cmdaexcel1' AS cmdaexcel WITH ;
		BackColor = 255,255,128, ;
		calias = rmvtos, ;
		cgriddata = thisform.grimodelos, ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 26, ;
		Left = 890, ;
		Name = "Cmdaexcel1", ;
		Picture = ..\..\, ;
		PicturePosition = 1, ;
		SpecialEffect = 0, ;
		TabIndex = 19, ;
		Top = 535, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\salidas.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcal1' AS cmdcal WITH ;
		Height = 33, ;
		Left = 802, ;
		Name = "Cmdcal1", ;
		Top = 58, ;
		txtnombre = txtfechainicial, ;
		Width = 35
		*< END OBJECT: ClassLib="..\libs\lmcal.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcal2' AS cmdcal WITH ;
		Height = 33, ;
		Left = 802, ;
		Name = "Cmdcal2", ;
		Top = 94, ;
		txtnombre = txtfechafinal, ;
		Width = 34
		*< END OBJECT: ClassLib="..\libs\lmcal.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcerraro' AS cmdcerraro WITH ;
		BackColor = 255,255,128, ;
		Caption = "\<Retornar", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 26, ;
		Left = 969, ;
		Name = "Cmdcerraro", ;
		OLEDragPicture = ..\, ;
		Picture = ..\..\, ;
		PicturePosition = 1, ;
		SpecialEffect = 0, ;
		TabIndex = 16, ;
		Top = 535, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdconsulta' AS commandbutton WITH ;
		BackColor = 255,255,128, ;
		Caption = "Consultar", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Height = 25, ;
		Left = 894, ;
		Name = "cmdconsulta", ;
		Picture = ..\graphics\65.bmp, ;
		PicturePosition = 1, ;
		TabIndex = 15, ;
		Top = 72, ;
		Width = 81
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Container1' AS container WITH ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		BorderColor = 255,255,255, ;
		Height = 89, ;
		Left = 5, ;
		Name = "Container1", ;
		TabIndex = 1, ;
		Top = 40, ;
		Width = 979
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'grimodelos' AS grid WITH ;
		AllowAddNew = .F., ;
		BackColor = 234,234,234, ;
		ColumnCount = 12, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		HeaderHeight = 29, ;
		Height = 384, ;
		HighlightBackColor = 187,221,255, ;
		HighlightForeColor = 0,0,0, ;
		HighlightStyle = 1, ;
		Left = 5, ;
		Name = "grimodelos", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RowHeight = 25, ;
		ScrollBars = 2, ;
		TabIndex = 17, ;
		Themes = .F., ;
		Top = 135, ;
		Visible = .T., ;
		Width = 1048, ;
		Column1.BackColor = 234,234,234, ;
		Column1.FontName = "Tahoma", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Visible = .T., ;
		Column1.Width = 80, ;
		Column2.BackColor = 234,234,234, ;
		Column2.ColumnOrder = 2, ;
		Column2.FontName = "Tahoma", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column3", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 72, ;
		Column3.BackColor = 234,234,234, ;
		Column3.ColumnOrder = 4, ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 8, ;
		Column3.Format = "", ;
		Column3.InputMask = "", ;
		Column3.Name = "Column4", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .T., ;
		Column3.Width = 250, ;
		Column4.BackColor = 234,234,234, ;
		Column4.ColumnOrder = 5, ;
		Column4.FontName = "Tahoma", ;
		Column4.FontSize = 8, ;
		Column4.Format = "", ;
		Column4.InputMask = "", ;
		Column4.Name = "Column5", ;
		Column4.ReadOnly = .T., ;
		Column4.Visible = .T., ;
		Column4.Width = 67, ;
		Column5.BackColor = 234,234,234, ;
		Column5.ColumnOrder = 6, ;
		Column5.FontName = "Tahoma", ;
		Column5.FontSize = 8, ;
		Column5.Format = "", ;
		Column5.InputMask = "", ;
		Column5.Name = "Column6", ;
		Column5.ReadOnly = .T., ;
		Column5.Visible = .T., ;
		Column5.Width = 59, ;
		Column6.BackColor = 234,234,234, ;
		Column6.ColumnOrder = 7, ;
		Column6.FontName = "Tahoma", ;
		Column6.FontSize = 8, ;
		Column6.Format = "999,999.99", ;
		Column6.InputMask = "999,999.99", ;
		Column6.Name = "Column7", ;
		Column6.ReadOnly = .T., ;
		Column6.Visible = .T., ;
		Column6.Width = 63, ;
		Column7.BackColor = 234,234,234, ;
		Column7.ColumnOrder = 8, ;
		Column7.FontName = "Tahoma", ;
		Column7.FontSize = 8, ;
		Column7.Format = "999,999.99", ;
		Column7.InputMask = "999,999.99", ;
		Column7.Name = "Column8", ;
		Column7.ReadOnly = .T., ;
		Column7.Visible = .T., ;
		Column7.Width = 67, ;
		Column8.BackColor = 234,234,234, ;
		Column8.ColumnOrder = 9, ;
		Column8.FontName = "Tahoma", ;
		Column8.FontSize = 8, ;
		Column8.Format = "9,999,999.99", ;
		Column8.InputMask = "9,999,999.99", ;
		Column8.Name = "Column9", ;
		Column8.ReadOnly = .T., ;
		Column8.Visible = .T., ;
		Column8.Width = 73, ;
		Column9.Alignment = 2, ;
		Column9.BackColor = 234,234,234, ;
		Column9.ColumnOrder = 10, ;
		Column9.CurrentControl = "Link1", ;
		Column9.FontName = "Tahoma", ;
		Column9.FontSize = 8, ;
		Column9.Name = "Column10", ;
		Column9.ReadOnly = .T., ;
		Column9.Sparse = .F., ;
		Column9.Visible = .T., ;
		Column9.Width = 60, ;
		Column10.BackColor = 234,234,234, ;
		Column10.ColumnOrder = 11, ;
		Column10.CurrentControl = "Link1", ;
		Column10.FontName = "Tahoma", ;
		Column10.FontSize = 8, ;
		Column10.Name = "Column11", ;
		Column10.ReadOnly = .T., ;
		Column10.Sparse = .F., ;
		Column10.Visible = .T., ;
		Column10.Width = 60, ;
		Column11.Alignment = 2, ;
		Column11.BackColor = 234,234,234, ;
		Column11.ColumnOrder = 3, ;
		Column11.CurrentControl = "Text1", ;
		Column11.FontName = "Tahoma", ;
		Column11.FontSize = 8, ;
		Column11.Name = "Column2", ;
		Column11.ReadOnly = .F., ;
		Column11.Sparse = .F., ;
		Column11.Visible = .T., ;
		Column11.Width = 88, ;
		Column12.BackColor = 234,234,234, ;
		Column12.CurrentControl = "Link1", ;
		Column12.FontName = "Tahoma", ;
		Column12.FontSize = 8, ;
		Column12.Name = "Column12", ;
		Column12.ReadOnly = .T., ;
		Column12.Sparse = .F., ;
		Column12.Visible = .T., ;
		Column12.Width = 69
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'grimodelos.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "N° Documento", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column1.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column10.Cmdconsulta1' AS cmdconsulta WITH ;
		Caption = "Generar", ;
		Left = 8, ;
		Name = "Cmdconsulta1", ;
		Picture = ..\, ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'grimodelos.Column10.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Reimprimir", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column10.Link1' AS link WITH ;
		Left = 6, ;
		Name = "Link1", ;
		Top = 34, ;
		Image1.Name = "Image1"
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="container" />

	ADD OBJECT 'grimodelos.Column10.Text1' AS textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column11.Cmd1' AS cmd WITH ;
		Left = 12, ;
		Name = "Cmd1", ;
		Top = 34
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'grimodelos.Column11.Cmdconsulta1' AS cmdconsulta WITH ;
		Caption = "Enviar", ;
		Left = 6, ;
		Name = "Cmdconsulta1", ;
		Picture = ..\, ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'grimodelos.Column11.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Email Cliente", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column11.Link1' AS link WITH ;
		Left = 41, ;
		Name = "Link1", ;
		Top = 34, ;
		Image1.Name = "Image1", ;
		Image1.Picture = ..\..\librerias\graficos\1492692438-4email_83540 (1).ico
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="container" />

	ADD OBJECT 'grimodelos.Column11.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column12.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 176,176,255, ;
		Caption = "Email Otros", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column12.Link1' AS link WITH ;
		Left = 11, ;
		Name = "Link1", ;
		Top = 46, ;
		Image1.Name = "Image1", ;
		Image1.Picture = ..\..\librerias\graficos\1492692438-4email_83540 (1).ico
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="container" />

	ADD OBJECT 'grimodelos.Column12.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column2.Ckpreciosa1' AS ckpreciosa WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Centered = .T., ;
		Left = 4, ;
		Name = "Ckpreciosa1", ;
		ReadOnly = .F., ;
		Top = 34, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="checkbox" />

	ADD OBJECT 'grimodelos.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 176,176,255, ;
		Caption = "RUC/DNI", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column2.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Fecha", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column3.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Razón Social", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column4.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Subtotal", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column5.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Exonerado", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column6.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Inafecto", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column7.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column8.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "IGV", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column8.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grimodelos.Column9.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 196,196,255, ;
		Caption = "Importe", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grimodelos.Column9.Text1' AS textbox WITH ;
		BackColor = 234,234,234, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Label1' AS label WITH ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		Caption = "Inicio:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 12, ;
		Left = 725, ;
		Name = "Label1", ;
		TabIndex = 3, ;
		Top = 48, ;
		Width = 36
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		BackColor = 255,255,176, ;
		BackStyle = 0, ;
		Caption = "Final:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 13, ;
		Left = 727, ;
		Name = "Label2", ;
		TabIndex = 4, ;
		Top = 88, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Serie:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 18, ;
		Name = "Label5", ;
		TabIndex = 18, ;
		Top = 110, ;
		Width = 39
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Optbusqueda' AS optbusqueda WITH ;
		BackStyle = 0, ;
		Height = 21, ;
		Left = 80, ;
		Name = "Optbusqueda", ;
		Top = 532, ;
		Width = 216, ;
		optdescripcion.BackStyle = 0, ;
		optdescripcion.Caption = "Nombre", ;
		optdescripcion.FontName = "Tahoma", ;
		optdescripcion.FontSize = 8, ;
		optdescripcion.Left = 5, ;
		optdescripcion.Name = "optdescripcion", ;
		optdescripcion.Top = 7, ;
		optcodigo.BackStyle = 0, ;
		optcodigo.Caption = "N° Documento", ;
		optcodigo.FontName = "Tahoma", ;
		optcodigo.FontSize = 8, ;
		optcodigo.Height = 17, ;
		optcodigo.Left = 110, ;
		optcodigo.Name = "optcodigo", ;
		optcodigo.Top = 7, ;
		optcodigo.Width = 103
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'titulo1' AS titulo WITH ;
		Left = 0, ;
		Name = "titulo1", ;
		Top = -1, ;
		Shape1.Name = "Shape1", ;
		Lbl1.Caption = "[Reporte de Documentos de Ventas Emitidos]", ;
		Lbl1.Name = "Lbl1", ;
		Image1.Name = "Image1", ;
		Image3.Name = "Image3", ;
		Image2.Name = "Image2"
		*< END OBJECT: ClassLib="..\..\librerias\clasesvisuales.vcx" BaseClass="container" />

	ADD OBJECT 'Txtfechafinal' AS txtfechafinal WITH ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 727, ;
		Name = "Txtfechafinal", ;
		SpecialEffect = 1, ;
		TabIndex = 14, ;
		Top = 103, ;
		Width = 76
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'Txtfechainicial' AS txtfechainicial WITH ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 725, ;
		Name = "Txtfechainicial", ;
		SpecialEffect = 1, ;
		TabIndex = 13, ;
		Top = 64, ;
		Width = 76
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'Txtlocalizador1' AS txtlocalizador WITH ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 25, ;
		Left = 312, ;
		Name = "Txtlocalizador1", ;
		TabIndex = 1, ;
		Top = 534, ;
		Width = 372
		*< END OBJECT: ClassLib="..\libs\sisven.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtserie' AS textbox WITH ;
		BorderColor = 224,224,224, ;
		Enabled = .T., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Format = "!", ;
		Height = 23, ;
		Left = 120, ;
		MaxLength = 4, ;
		Name = "txtserie", ;
		ReadOnly = .F., ;
		SpecialEffect = 1, ;
		TabIndex = 9, ;
		Top = 102, ;
		Width = 132
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Init
		Settear()
		If datosGlobales()=0 Then
			Return .F.
		Endif
		Thisform.GRimodelos.RecordSource=""
		If MuestraDctos("")=0 Then
			Return .F.
		Endif
		Select * From dctosv Into Cursor ldctos
		With Thisform
			.cmbdcto.RowSource="ldctos.nomb"
			.cmbdcto.ListIndex=1
			.cmbmoneda.ListIndex=1
			.GRimodelos.RecordSource=""
		Endwith
		
	ENDPROC

	PROCEDURE Cmbtienda.LostFocus
		thisform.nalmacen=ltdas.idalma
		
	ENDPROC

	PROCEDURE Cmdaexcel1.Click
		If verificaAlias("rmvtos")=1 Then
			This.titulo1="Reporte de Transacciones"
			This.calias="rmvtos"
			This.cgriddata="thisform.grimodelos"
			DoDefault()
		Endif
		
	ENDPROC

	PROCEDURE cmdconsulta.Click
		With Thisform
			.grimodelos.RecordSource=""
			dfi=.txtfechainicial.Value
			dff=.txtfechafinal.Value
			If .chktienda.Value=0 Then
				TEXT TO lc NOSHOW
				    SELECT ndoc as dcto,a.fech,b.nruc,b.razo,a.valor,a.rcom_exon,CAST(0 as decimal(12,2)) as inafecto,
				    a.igv,a.impo,rcom_hash,rcom_mens,mone,a.tdoc,a.ndoc,idauto,rcom_arch,b.clie_corr,tcom
				    FROM fe_rcom as a JOIN fe_clie as b ON (a.idcliente=b.idclie)
				    where a.fech between ?dfi and ?dff  and
				    a.acti<>'I' order by fech,ndoc
				ENDTEXT
			Else
				nidcodt=.nalmacen
				TEXT TO lc NOSHOW
				    SELECT a.ndoc as dcto,a.fech,b.nruc,b.razo,a.valor,a.rcom_exon,CAST(0 as decimal(12,2)) as inafecto,
				    a.igv,a.impo,rcom_hash,rcom_mens,mone,a.tdoc,a.ndoc,idauto,rcom_arch,b.clie_corr,tcom
				    FROM fe_rcom as a JOIN fe_clie as b ON (a.idcliente=b.idclie)
				    where a.fech between ?dfi and ?dff  and a.acti<>'I'  and a.codt=?nidcodt
				     order by fech,ndoc
				ENDTEXT
			ENDIF
				IF verificaconexion()=0 then
		RETURN 0
		endif
			ncon=AbreConexion()
			If SQLExec(ncon,lc,"rmvtos")<0
				errorbd(lc)
				Return
			Else
				CierraConexion(ncon)
				Select dcto,fech,nruc,razo,valor,rcom_exon,inafecto,igv,Impo,rcom_hash,rcom_mens,mone,tdoc,ndoc,idauto,rcom_arch,clie_corr,tcom;
					From rmvtos Into Cursor rmvtos
				If .chkdcto.Value=1 Then
					Select * From rmvtos Where tdoc=ldctos.tdoc Into Cursor rmvtos 
				Endif
				If !Empty(.txtserie.Value) Then
					cserie=.txtserie.Value
					Select * From rmvtos Where Left(ndoc,4)=cserie Into Cursor rmvtos 
				Endif
				Select * From rmvtos Into Cursor lll
				goapp.tituloinforme="Informe de Respuestas de CPE"
				goapp.subtituloinforme="Desde: "+Dtoc(dfi)+" Hasta: "+Dtoc(dff)
				.grimodelos.RecordSource="rmvtos"
			Endif
		Endwith
		
	ENDPROC

	PROCEDURE grimodelos.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE grimodelos.Column10.Cmdconsulta1.Click
		Set Procedure To capadatos,enviarcorreo,ple5,imprimir,rngrifo Additive
		ReimprimirStandargrifo(rmvtos.idauto,rmvtos.tdoc,rmvtos.tcom)
		car=Justfname(rmvtos.rcom_arch)
		npos=At(".",car)
		carpdf=Left(car,npos-1)+'.Pdf'
		obji=Createobject("Imprimir")
		obji.tdoc=rmvtos.tdoc
		obji.ImprimeComprobante('N')
		obji.ArchivoPdf=carpdf
		obji.GeneraPDF('S')
	ENDPROC

	PROCEDURE grimodelos.Column10.Link1.ejecutar
		Set Procedure To capadatos,enviarcorreo,ple5,imprimir,rngrifo Additive
		ReimprimirStandargrifo(rmvtos.idauto,rmvtos.tdoc,rmvtos.tcom)
		car=Justfname(rmvtos.rcom_arch)
		npos=At(".",car)
		carpdf=Left(car,npos-1)+'.Pdf'
		obji=Createobject("Imprimir")
		obji.tdoc=rmvtos.tdoc
		obji.ImprimeComprobante('N')
		obji.ArchivoPdf=carpdf
		obji.GeneraPDF('S')
	ENDPROC

	PROCEDURE grimodelos.Column11.Cmdconsulta1.Click
		If Empty(rmvtos.clie_corr) Or Alltrim(rmvtos.clie_corr)="@" Or Len(Alltrim(rmvtos.clie_corr))<=1 Then
			Messagebox("Correo Electrónico No Válido",16,MSGTITULO)
			Return
		Endif
		Set Procedure To capadatos,enviarcorreo,ple5,imprimir,rngrifo Additive
		
		scorreo=DevuelveServidorCorreo()
		ReimprimirStandargrifo(rmvtos.idauto,rmvtos.tdoc,rmvtos.tcom)
		
		If Empty(rmvtos.rcom_arch) And rmvtos.Impo<>0 Then
			Set Procedure To capadatos,ple5 Additive
			carfile=Adjuntar(rmvtos.idauto,rmvtos.ndoc,rmvtos.tdoc)
			If Empty(carfile) Then
				Return
			Endif
		Else
			carfile=Justfname(rmvtos.rcom_arch)
		Endif
		
		
		*carfile=Justfname(rmvtos.rcom_arch)
		npos=At(".",carfile)
		carpdf=Left(carfile,npos-1)+'.Pdf'
		obji=Createobject("Imprimir")
		obji.tdoc=rmvtos.tdoc
		obji.ImprimeComprobante('N')
		obji.ArchivoPdf=carpdf
		obji.GeneraPDF('N')
		cpdf=Addbs(Sys(5)+Sys(2003)+'\PDF\')+carpdf
		carchivo1=Addbs(Sys(5)+Sys(2003)+'\FirmaXML\')+carfile
		loMail = Createobject("Cdo2000")
		With loMail
		If Upper(scorreo)=="GMAIL" Then
				.cServer = "smtp.gmail.com"
				.nServerPort = 465 &&gmail
			Else
				.cServer = "smtp.live.com"
				.nServerPort = 25 &&Hotmail.com
			Endif
			.lUseSSL = .T.
		
			.nAuthenticate = 1 	&& cdoBasic
		*.cUserName = "eduartch@hotmail.com"&&
		*.cPassword = "lab302a25486373"&&
			.cUserName = Alltrim(fe_gene.correo)
			.cPassword = Alltrim(fe_gene.gene_ccor)
			.cFrom = .cUserName
			.cTo = rmvtos.clie_corr
		&&"eduartch@gmail.com"&&Destinatario
		
			.cSubject = "EMISIÓN DEL COMPROBANTE DE PAGO ELECTRÓNICO:" +rmvtos.ndoc
		
			ctexto="Por la presente le comunicamos que la empresa "+ Alltrim(fe_gene.empresa)+"  emisora de comprobantes electrónicos le ha emitido el siguiente comprobante:" +Chr(13)
		&&se usa cunado se va enviar solo texto
		
			ctexto=ctexto+"Tipo de Documento:"+Icase(rmvtos.tdoc='01',"FACTURA",rmvtos.tdoc='03',"BOLETA",rmvtos.tdoc='07',"Nota de Crédito","Nota de Debito")+ Chr(13)
			ctexto=ctexto+"Serie y número:" +Alltrim(rmvtos.ndoc)+Chr(13)
			ctexto=ctexto+"RUC del emisor :"+Alltrim(fe_gene.nruc)+Chr(13)
			ctexto=ctexto+"RUC o DNI del Cliente:"+Alltrim(rmvtos.nruc) +Chr(13)
			*ctexto=ctexto+"Fecha de emisión:"+Alltrim(Dtoc(rmvtos.fech))
			
			*.cSubject = "Documento Electrónico Tributario"&&Asunto
		
		*lcHTML = "<HTML>" + "Texto" + "</HTML>"
		*lcHTML = STRTRAN(lcHTML, "contentEditable=true", "")
			*.cTextBody = "Por medio de la presente es grato saludarle y a la vez hacerle llegar su FACTURA ELECTRONICA en formato PDF y XML" &&se usa cunado se va enviar solo texto
		*.cHtmlBody = lcHTML
		
		*lcAttach = "c:\psys\firmaxml\20479597139-RC-20161105-001.xml"
		
			carchivo2=cpdf
		*.cAttachment   = "c:\psys\firmaxml\20479597139-RC-20161105-001.xml"+","+"c:\psys\firmaxml\20479597139-RC-20161105-001.xml"
			.cAttachment   = carchivo1+","+carchivo2
			cRecep = ""
		*Normal
		*High	= Alto
		*Low	= Bajo
			cPrioridad = "High"
			.cReplyTo  = cRecep
			.cPriority = cPrioridad
		Endwith
		If loMail.Send() > 0
			For i=1 To loMail.GetErrorCount()
				Messagebox(Alltrim(Str(i))+" - "+loMail.Geterror(i),16,"Error...")
			Endfor
		Else
			Messagebox("Se envio correctamente el correo:"+rmvtos.clie_corr,64,"Infromacion...")
		Endif
		
	ENDPROC

	PROCEDURE grimodelos.Column11.Link1.ejecutar
		If Empty(rmvtos.clie_corr) Or Alltrim(rmvtos.clie_corr)="@" Or Len(Alltrim(rmvtos.clie_corr))<=1 Then
			Messagebox("Correo Electrónico NO Válido",16,MSGTITULO)
			return
		Endif
		Set Procedure To capadatos,enviarcorreo,ple5,imprimir,rngrifo Additive
		ReimprimirStandargrifo(rmvtos.idauto,rmvtos.tdoc,rmvtos.tcom)
		
		If Empty(rmvtos.rcom_arch) And rmvtos.Impo<>0 Then
			Set Procedure To capadatos,ple5 Additive
			carfile=Adjuntar(rmvtos.idauto,rmvtos.ndoc,rmvtos.tdoc)
			If Empty(car) Then
				Return
			Endif
		Else
			carfile=Justfname(rmvtos.rcom_arch)
		Endif
		*carfile=Justfname(rmvtos.rcom_arch)
		npos=At(".",carfile)
		carpdf=Left(carfile,npos-1)+'.Pdf'
		obji=Createobject("Imprimir")
		obji.tdoc=rmvtos.tdoc
		obji.ImprimeComprobante('N')
		obji.ArchivoPdf=carpdf
		obji.GeneraPDF('N')
		cpdf=Addbs(Sys(5)+Sys(2003)+'\PDF\')+carpdf
		carchivo1=Addbs(Sys(5)+Sys(2003)+'\FirmaXML\')+carfile
		loMail = Createobject("Cdo2000")
		With loMail
			.cServer = "smtp.live.com"
			*.cServer = "smtp.gmail.com"
			*.nServerPort = 465 &&gmail
			.nServerPort = 25 &&Hotmail.com
			.lUseSSL = .T.
		
			.nAuthenticate = 1 	&& cdoBasic
			*.cUserName = "eduartch@hotmail.com"&&
			*.cPassword = "lab302a25486373"&&
			.cUserName = Alltrim(fe_gene.correo)
			.cPassword = Alltrim(fe_gene.gene_ccor)
			.cFrom = .cUserName
			.cTo = rmvtos.clie_corr
			&&"eduartch@gmail.com"&&Destinatario
		
			.cSubject = "Documento Electrónico Tributario"&&Asunto
		
			*lcHTML = "<HTML>" + "Texto" + "</HTML>"
			*lcHTML = STRTRAN(lcHTML, "contentEditable=true", "")
			.cTextBody = "Por medio de la presente es grato saludarle y a la vez hacerle llegar su FACTURA ELECTRONICA en formato PDF y XML" &&se usa cunado se va enviar solo texto
			*.cHtmlBody = lcHTML
		
			*lcAttach = "c:\psys\firmaxml\20479597139-RC-20161105-001.xml"
			
			carchivo2=cpdf
			*.cAttachment   = "c:\psys\firmaxml\20479597139-RC-20161105-001.xml"+","+"c:\psys\firmaxml\20479597139-RC-20161105-001.xml"
			.cAttachment   = carchivo1+","+carchivo2
			cRecep = ""
			*Normal
			*High	= Alto
			*Low	= Bajo
			cPrioridad = "High"
			.cReplyTo  = cRecep
			.cPriority = cPrioridad
		Endwith
		If loMail.Send() > 0
			For i=1 To loMail.GetErrorCount()
				Messagebox(Alltrim(Str(i))+" - "+loMail.Geterror(i),16,"Error...")
			Endfor
		Else
			Messagebox("Se envio correctamente el correo:"+rmvtos.clie_corr,64,"Infromacion...")
		Endif
		
	ENDPROC

	PROCEDURE grimodelos.Column12.Link1.ejecutar
		Set Procedure To capadatos,enviarcorreo,ple5,imprimir,rngrifo Additive
		ReimprimirStandargrifo(rmvtos.idauto,rmvtos.tdoc,rmvtos.tcom)
		*carfile=Justfname(rmvtos.rcom_arch)
		
		If Empty(rmvtos.rcom_arch) And rmvtos.Impo<>0 Then
			Set Procedure To capadatos,ple5 Additive
			carfile=AdjuntarM(rmvtos.idauto,rmvtos.ndoc,rmvtos.tdoc)
			If Empty(carfile) Then
				Return
			Endif
		Else
			carfile=Justfname(rmvtos.rcom_arch)
		Endif
		
		
		npos=At(".",carfile)
		carpdf=Left(carfile,npos-1)+'.Pdf'
		obji=Createobject("Imprimir")
		obji.tdoc=rmvtos.tdoc
		obji.ImprimeComprobante('N')
		obji.ArchivoPdf=carpdf
		obji.GeneraPDF('N')
		cpdf=Addbs(Sys(5)+Sys(2003)+'\PDF\')+carpdf
		carchivo1=Addbs(Sys(5)+Sys(2003)+'\FirmaXML\')+carfile
		Do Form ka_sendmail With carpdf,carchivo1
		
	ENDPROC

	PROCEDURE Txtlocalizador1.InteractiveChange
		Local cvalor
		If verificaAlias("rmvtos")=1 Then
			cvalor=Alltrim(This.Value)
			Thisform.grimodelos.RecordSource=""
			If Thisform.optbusqueda.optcodigo.Value=1 Then
				Thisform.grimodelos.RecordSource=""
				Select * From lll Where ndoc Like '%'+cvalor+'%' Into Cursor rmvtos  
			Else
				Select * From lll Where razo Like '%'+cvalor+'%' Into Cursor rmvtos
			Endif
			Thisform.grimodelos.RecordSource="rmvtos"
			Thisform.grimodelos.SetAll("dynamicbackcolor","iif(MOD(RECNO(),2)=0,RGB(234,234,255),RGB(247,247,242))","Column")
		Endif
		
	ENDPROC

	PROCEDURE Txtlocalizador1.LostFocus
		thisform.grimodelos.SetFocus 
	ENDPROC

ENDDEFINE
