*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="cr_ccreditos.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\sisfotos.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 481
	Left = -4
	Name = "Dataenvironment"
	Top = 193
	Width = 792

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "fe_cred", ;
		BufferModeOverride = 5, ;
		CursorSource = "fe_cred", ;
		Database = ..\data\sisven.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "fe_clie", ;
		BufferModeOverride = 5, ;
		CursorSource = "fe_clie", ;
		Database = ..\data\sisven.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "fe_tdoc", ;
		CursorSource = "fe_tdoc", ;
		Database = ..\data\sisven.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "fe_num", ;
		CursorSource = "fe_num", ;
		Database = ..\data\sisven.dbc, ;
		Height = 90, ;
		Left = 570, ;
		Name = "Cursor4", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "fe_cod", ;
		BufferModeOverride = 5, ;
		CursorSource = "fe_cod", ;
		Database = ..\data\sisven.dbc, ;
		Height = 90, ;
		Left = 427, ;
		Name = "Cursor5", ;
		Top = 23, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "fe_caja", ;
		BufferModeOverride = 5, ;
		CursorSource = "fe_caja", ;
		Database = ..\data\sisven.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor6", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS forcreditos AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdregistra" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdamortiza" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdestado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdactualiza" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcerraro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtopcion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtbuscar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdlista" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Line1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtsaldo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblcodigo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblfono" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblfax" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblrazon" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblruc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lbldireccion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdvtos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="griclientes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="griclientes.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="griclientes.Column1.Text1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: cliente
		*p: codigocliente
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 1
	Caption = "[Control de Créditos y Cobranzas(Moneda Nacional)]"
	cliente = 
	Closable = .F.
	codigocliente = 
	ControlBox = .F.
	DoCreate = .T.
	Height = 507
	Icon = ..\
	MaxButton = .F.
	MinButton = .F.
	Movable = .T.
	Name = "FORCREDITOS"
	ShowWindow = 1
	Width = 651
	WindowState = 0
	WindowType = 0

	ADD OBJECT 'cmdactualiza' AS commandbutton WITH ;
		Caption = "(4) Actualizar ", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 240, ;
		Name = "cmdactualiza", ;
		Picture = ..\graphics\cancelar.ico, ;
		TabIndex = 8, ;
		Top = 240, ;
		Width = 196
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdamortiza' AS commandbutton WITH ;
		Caption = "(2) Pagos", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 239, ;
		Name = "cmdamortiza", ;
		Picture = ..\graphics\open.bmp, ;
		TabIndex = 6, ;
		Top = 163, ;
		Width = 196
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcerraro' AS cmdcerraro WITH ;
		Caption = "(7) \<Retornar", ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 240, ;
		Name = "Cmdcerraro", ;
		Picture = ..\graphics\close.bmp, ;
		TabIndex = 11, ;
		Top = 355, ;
		Width = 196
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdestado' AS commandbutton WITH ;
		Caption = "(3) Estado ", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 239, ;
		Name = "cmdestado", ;
		Picture = ..\graphics\txt.bmp, ;
		TabIndex = 7, ;
		Top = 201, ;
		Width = 196
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdlista' AS commandbutton WITH ;
		Caption = "(6) Clientes", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 239, ;
		Name = "cmdlista", ;
		Picture = ..\graphics\happy.bmp, ;
		TabIndex = 10, ;
		Top = 317, ;
		Width = 196
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdregistra' AS commandbutton WITH ;
		Caption = "(1) Registrar ", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 239, ;
		Name = "cmdregistra", ;
		Picture = ..\graphics\books04.ico, ;
		TabIndex = 5, ;
		Top = 124, ;
		Width = 196
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdvtos' AS commandbutton WITH ;
		Caption = "(5) Vencimientos", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 38, ;
		Left = 240, ;
		Name = "cmdvtos", ;
		Picture = ..\graphics\hand.bmp, ;
		TabIndex = 9, ;
		Top = 278, ;
		Width = 196
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'griclientes' AS grid WITH ;
		BackColor = 174,202,210, ;
		ColumnCount = 1, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		HeaderHeight = 37, ;
		Height = 418, ;
		HighlightBackColor = 255,255,0, ;
		HighlightForeColor = 0,0,0, ;
		HighlightStyle = 1, ;
		Left = 1, ;
		Name = "griclientes", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordSource = "", ;
		ScrollBars = 2, ;
		TabIndex = 2, ;
		Top = 3, ;
		Width = 535, ;
		Column1.BackColor = 174,202,210, ;
		Column1.ControlSource = "", ;
		Column1.FontName = "Tahoma", ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 503
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'griclientes.Column1.Header1' AS header WITH ;
		BackColor = 0,0,255, ;
		Caption = "Lista de Clientes [PRESIONE  <SUPR> PARA BUSCAR]", ;
		FontBold = .T., ;
		FontCondense = .F., ;
		FontName = "Tahoma", ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'griclientes.Column1.Text1' AS textbox WITH ;
		BackColor = 174,202,210, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Label1' AS label WITH ;
		Alignment = 2, ;
		Caption = "Menú de Operaciones", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		FontSize = 12, ;
		FontUnderline = .T., ;
		Height = 19, ;
		Left = 248, ;
		Name = "Label1", ;
		TabIndex = 4, ;
		Top = 102, ;
		Width = 176
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label10' AS label WITH ;
		Caption = "Dirección......:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 15, ;
		Left = 11, ;
		Name = "Label10", ;
		TabIndex = 21, ;
		Top = 77, ;
		Width = 74
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		Caption = "Elija su Opción:", ;
		FontBold = .T., ;
		Height = 15, ;
		Left = 275, ;
		Name = "Label2", ;
		TabIndex = 13, ;
		Top = 396, ;
		Width = 87
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		Caption = "Saldo..:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 14, ;
		Left = 352, ;
		Name = "Label3", ;
		TabIndex = 14, ;
		Top = 78, ;
		Width = 46
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		Caption = "Razón Social:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 15, ;
		Left = 10, ;
		Name = "Label4", ;
		TabIndex = 16, ;
		Top = 32, ;
		Width = 80
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		Caption = "Nº Ruc............:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 15, ;
		Left = 10, ;
		Name = "Label5", ;
		TabIndex = 17, ;
		Top = 56, ;
		Width = 75
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		Caption = "Código...........:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 16, ;
		Left = 10, ;
		Name = "Label6", ;
		TabIndex = 18, ;
		Top = 8, ;
		Width = 73
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		Caption = "Buscar:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 14, ;
		Left = -1, ;
		Name = "Label7", ;
		TabIndex = 12, ;
		Top = 420, ;
		Width = 43
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label8' AS label WITH ;
		Caption = "Fono....:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 15, ;
		Left = 226, ;
		Name = "Label8", ;
		TabIndex = 19, ;
		Top = 9, ;
		Width = 45
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label9' AS label WITH ;
		Caption = "Fax...:", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		Height = 14, ;
		Left = 370, ;
		Name = "Label9", ;
		TabIndex = 20, ;
		Top = 10, ;
		Width = 37
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblcodigo' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Label11", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 94, ;
		Name = "lblcodigo", ;
		TabIndex = 22, ;
		Top = 6, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lbldireccion' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Label16", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 94, ;
		Name = "lbldireccion", ;
		TabIndex = 27, ;
		Top = 77, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblfax' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Label13", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 406, ;
		Name = "lblfax", ;
		TabIndex = 24, ;
		Top = 10, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblfono' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Label12", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 275, ;
		Name = "lblfono", ;
		TabIndex = 23, ;
		Top = 9, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblrazon' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Label14", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 94, ;
		Name = "lblrazon", ;
		TabIndex = 25, ;
		Top = 31, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblruc' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Label15", ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 94, ;
		Name = "lblruc", ;
		TabIndex = 26, ;
		Top = 53, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Line1' AS line WITH ;
		BorderWidth = 2, ;
		Height = 1, ;
		Left = -1, ;
		Name = "Line1", ;
		Top = 96, ;
		Width = 792
		*< END OBJECT: BaseClass="line" />

	ADD OBJECT 'Txtbuscar' AS txtbuscar WITH ;
		FontName = "Tahoma", ;
		Height = 22, ;
		Left = 48, ;
		Name = "Txtbuscar", ;
		SpecialEffect = 1, ;
		TabIndex = 1, ;
		Top = 420, ;
		Visible = .T., ;
		Width = 453
		*< END OBJECT: ClassLib="..\libs\sisfotos.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtopcion' AS textbox WITH ;
		Height = 22, ;
		Left = 369, ;
		MaxLength = 1, ;
		Name = "txtopcion", ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 3, ;
		Top = 396, ;
		Width = 35
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtsaldo' AS textbox WITH ;
		Alignment = 3, ;
		FontBold = .T., ;
		FontName = "Tahoma", ;
		ForeColor = 128,0,0, ;
		Format = "999,999.99", ;
		Height = 22, ;
		Left = 406, ;
		Name = "txtsaldo", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		TabIndex = 15, ;
		Top = 72, ;
		Value = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Init
		_screen.closable=.f.
		select razo,fono,nfax,nruc,dire,ciud,codc,saldo from fe_clie;
		into cursor clientes order by razo
		thisform.griclientes.recordsource="clientes"
	ENDPROC

	PROCEDURE cmdactualiza.Click
		do form cr_corrige with thisform.codigocliente,clientes.razo to saldo
		thisform.txtsaldo.value=saldo
		
	ENDPROC

	PROCEDURE cmdamortiza.Click
		*do form cr_vtosdocumentos with thisform.codigocliente
		do form cr_datos with thisform.codigocliente,clientes.razo,"Amortizar: ","P",thisform.txtsaldo.value to saldo
		thisform.txtsaldo.value=saldo
	ENDPROC

	PROCEDURE cmdestado.Click
		do form cr_estadocta with clientes.razo,thisform.codigocliente TO saldo
		thisform.txtsaldo.Value=saldo
		
	ENDPROC

	PROCEDURE cmdlista.Click
		thisform.griclientes.visible=.t.
		thisform.txtbuscar.visible=.t.
		thisform.griclientes.column1.text1.keypress(7) 
	ENDPROC

	PROCEDURE cmdregistra.Click
		do form cr_datos.scx with thisform.codigocliente,clientes.razo,"Registrar: ","C",thisform.txtsaldo.value to saldo
		thisform.txtsaldo.value=saldo
	ENDPROC

	PROCEDURE cmdvtos.Click
		do form cr_vtoscliente with thisform.lblcodigo.caption,thisform.lblrazon.caption
	ENDPROC

	PROCEDURE griclientes.Column1.Text1.DblClick
		thisform.griclientes.column1.text1.keypress(13)
	ENDPROC

	PROCEDURE griclientes.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		with thisform
		do case
		  case nkeycode=7
				.txtbuscar.value=""
				.txtbuscar.setfocus
		  case nkeycode=4 or nkeycode=5 or nkeycode=19 or nkeycode=24
				.griclientes.setfocus 
		  case nkeycode=13
				.griclientes.visible=.f.
				.txtbuscar.value=""
				.txtbuscar.visible=.f.     
				.codigocliente=clientes.codc
				.lblcodigo.caption=clientes.codc
				.lblrazon.caption=clientes.razo
				.lblfono.caption=clientes.fono
				.lblfax.caption=clientes.nfax
				.lblruc.caption=clientes.nruc
				.lbldireccion.caption=alltrim(clientes.dire)+' '+alltrim(clientes.ciud)
				select sum(impo)-sum(acta) as saldo from fe_cred where codc=clientes.codc into cursor sclientes
				update fe_clie set saldo=sclientes.saldo where codc=clientes.codc
		 		.txtsaldo.value=sclientes.saldo
				.txtopcion.setfocus
		endcase
		endwith
		
	ENDPROC

	PROCEDURE Txtbuscar.InteractiveChange
		thisform.griclientes.recordsource=""
		select razo,fono,nfax,nruc,dire,ciud,codc,saldo from fe_clie;
		where razo like '%'+alltrim(this.value)+'%' into cursor clientes order by razo
		thisform.griclientes.recordsource="clientes"
		
	ENDPROC

	PROCEDURE Txtbuscar.LostFocus
		thisform.griclientes.setfocus
	ENDPROC

	PROCEDURE txtopcion.InteractiveChange
		IF !empty(this.value)
		    DO CASE 
		       CASE this.value="1"
		            do form cr_datos with thisform.codigocliente,clientes.razo,"Registrar: ",;
		            "C",thisform.txtsaldo.value to saldo
		            thisform.txtsaldo.value=saldo
		       CASE this.value="2"
		            do form cr_datos with thisform.codigocliente,clientes.razo,"Amortizar: ",;
		            "P",thisform.txtsaldo.value to saldo   
		            thisform.txtsaldo.value=saldo
		       CASE this.value="3"
		            do form cr_estadocta with clientes.razo,thisform.codigocliente TO saldo 
		            thisform.txtsaldo.value=saldo
		       CASE this.value="4"
		            do form cr_corrige with thisform.codigocliente,clientes.razo to saldo
		            thisform.txtsaldo.value=saldo
		       CASE this.value="5"            
		            do form cr_vtoscliente with thisform.lblcodigo.caption,thisform.lblrazon.caption
		       CASE this.value="6"
		            thisform.griclientes.visible=.t.
		            thisform.txtbuscar.visible=.t.
		            thisform.griclientes.column1.text1.keypress(7) 
		       CASE this.value="6"
		            thisform.release
		    ENDCASE  
		ENDIF
	ENDPROC

ENDDEFINE
